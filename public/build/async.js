(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var
push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var
nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj;};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=_;}exports.ot_=_;}else{root.ot_=_;}_.VERSION='1.4.4';var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context);}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return;}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return;}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list));});return results;};var reduceError='Reduce of empty array with no initial value';_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator);}each(obj,function(value,index,list){if(!initial){memo=value;initial=true;}else{memo=iterator.call(context,memo,value,index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length;}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true;}else{memo=iterator.call(context,memo,obj[index],index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true;}});return result;};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results.push(value);});return results;};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list);},context);};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker;});return!!result;};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker;});return!!result;};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target;});};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key];});};_.where=function(obj,attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return _[first?'find':'filter'](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false;}return true;});};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true);};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj);}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed});});return result.value;};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj);}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed});});return result.value;};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value;});return shuffled;};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value];};};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1;}return left.index<right.index?-1:1;}),'value');};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value==null?_.identity:value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value);});return result;};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value);});};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key){if(!_.has(result,key))result[key]=0;result[key]++;});};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid;}return low;};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj);};_.size=function(obj){if(obj==null)return 0;return(obj.length===+obj.length)?obj.length:_.keys(obj).length;};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return(n!=null)&&!guard?slice.call(array,0,n):array[0];};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n));};_.last=function(array,n,guard){if(array==null)return void 0;if((n!=null)&&!guard){return slice.call(array,Math.max(array.length-n,0));}else{return array[array.length-1];}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n);};_.compact=function(array){return _.filter(array,_.identity);};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output);}else{output.push(value);}});return output;};_.flatten=function(array,shallow){return flatten(array,shallow,[]);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false;}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index]);}});return results;};_.union=function(){return _.uniq(_.flatten(arguments,true));};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0;});});};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value);});};_.zip=function(){return _.unzip(slice.call(arguments));};_.unzip=function(list){var length=_.max(_.pluck(list,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(list,''+i);}return results;};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}return result;};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted=='number'){i=(isSorted<0?Math.max(0,l+isSorted):isSorted);}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1;}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1;};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);}var i=(hasIndex?from:array.length);while(i--)if(array[i]===item)return i;return-1;};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0;}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step;}return range;};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self;};};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)));};};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)throw new Error("bindAll must be passed function names");each(funcs,function(f){obj[f]=_.bind(obj[f],obj);});return obj;};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments));};};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)));};_.throttle=function(func,wait,immediate){var context,args,result;var timeout=null;var previous=0;var later=function(){previous=new Date;timeout=null;result=func.apply(context,args);};return function(){var now=new Date;if(!previous&&immediate===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);}else if(!timeout){timeout=setTimeout(later,remaining);}return result;};};_.debounce=function(func,wait,immediate){var result;var timeout=null;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result;};};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo;};};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args);};};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)];}return args[0];};};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments);}};};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError('Invalid object');var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys;};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values;};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs;};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key);}return names.sort();};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop];}}});return obj;};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key];});return copy;};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key];}return copy;};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop];}}});return obj;};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case'[object String]':return a==String(b);case'[object Number]':return a!=+a?b!=+b:(a==0?1/a==1/b:a==+b);case'[object Date]':case'[object Boolean]':return+a==+b;case'[object RegExp]':return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;}if(typeof a!='object'||typeof b!='object')return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b;}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=='[object Array]'){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break;}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false;}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break;}}if(result){for(key in b){if(_.has(b,key)&&!(size--))break;}result=!size;}}aStack.pop();bStack.pop();return result;};_.isEqual=function(a,b){return eq(a,b,[],[]);};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true;};_.isElement=function(obj){return!!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=='[object Array]';};_.isObject=function(obj){return obj===Object(obj);};each(['Arguments','Function','String','Number','Date','RegExp'],function(name){_['is'+name]=function(obj){return toString.call(obj)=='[object '+name+']';};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,'callee'));};}if(typeof(/./)!=='function'){_.isFunction=function(obj){return typeof obj==='function';};}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=='[object Boolean]';};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}return min+Math.floor(Math.random()*(max-min+1));};var entityMap={escape:{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','/':'&#x2F;'}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp('['+_.keys(entityMap.escape).join('')+']','g'),unescape:new RegExp('('+_.keys(entityMap.unescape).join('|')+')','g')};_.each(['escape','unescape'],function(method){_[method]=function(string){if(string==null)return'';return(''+string).replace(entityRegexes[method],function(match){return entityMap[method][match];});};});_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value;};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args));};});};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'",'\\':'\\','\r':'r','\n':'n','\t':'t','\u2028':'u2028','\u2029':'u2029'};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|$','g');var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return'\\'+escapes[match];});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}if(evaluate){source+="';\n"+evaluate+"\n__p+='";}index=offset+match.length;return match;});source+="';\n";if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||'obj','_',source);}catch(e){e.source=source;throw e;}if(data)return render(data,_);var template=function(data){return render.call(this,data,_);};template.source='function('+(settings.variable||'obj')+'){\n'+source+'}';return template;};_.chain=function(obj){return _(obj).chain();};_.guid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});};var result=function(obj){return this._chain?_(obj).chain():obj;};_.mixin(_);each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=='shift'||name=='splice')&&obj.length===0)delete obj[0];return result.call(this,obj);};});each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments));};});_.extend(_.prototype,{chain:function(){this._chain=true;return this;},value:function(){return this._wrapped;}});}).call(this);(function(undefined){var moment,VERSION='2.8.0',globalScope=typeof global!=='undefined'?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule=(typeof module!=='undefined'&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat='YYYY-MM-DDTHH:mm:ssZ',isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d{2}-\d{2}/],['YYYY-MM-DD',/\d{4}-\d{2}-\d{2}/],['GGGG-[W]WW-E',/\d{4}-W\d{2}-\d/],['GGGG-[W]WW',/\d{4}-W\d{2}/],['YYYY-DDD',/\d{4}-\d{3}/]],isoTimes=[['HH:mm:ss.SSSS',/(T| )\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss',/(T| )\d\d:\d\d:\d\d/],['HH:mm',/(T| )\d\d:\d\d/],['HH',/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters='Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),unitMillisecondFactors={'Milliseconds':1,'Seconds':1e3,'Minutes':6e4,'Hours':36e5,'Days':864e5,'Months':2592e6,'Years':31536e6},unitAliases={ms:'millisecond',s:'second',m:'minute',h:'hour',d:'day',D:'date',w:'week',W:'isoWeek',M:'month',Q:'quarter',y:'year',DDD:'dayOfYear',e:'weekday',E:'isoWeekday',gg:'weekYear',GG:'isoWeekYear'},camelFunctions={dayofyear:'dayOfYear',isoweekday:'isoWeekday',isoweek:'isoWeek',weekyear:'weekYear',isoweekyear:'isoWeekYear'},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens='DDD w W M D d'.split(' '),paddedTokens='M D H h m s w W'.split(' '),formatTokenFunctions={M:function(){return this.month()+1;},MMM:function(format){return this.localeData().monthsShort(this,format);},MMMM:function(format){return this.localeData().months(this,format);},D:function(){return this.date();},DDD:function(){return this.dayOfYear();},d:function(){return this.day();},dd:function(format){return this.localeData().weekdaysMin(this,format);},ddd:function(format){return this.localeData().weekdaysShort(this,format);},dddd:function(format){return this.localeData().weekdays(this,format);},w:function(){return this.week();},W:function(){return this.isoWeek();},YY:function(){return leftZeroFill(this.year()%100,2);},YYYY:function(){return leftZeroFill(this.year(),4);},YYYYY:function(){return leftZeroFill(this.year(),5);},YYYYYY:function(){var y=this.year(),sign=y>=0?'+':'-';return sign+leftZeroFill(Math.abs(y),6);},gg:function(){return leftZeroFill(this.weekYear()%100,2);},gggg:function(){return leftZeroFill(this.weekYear(),4);},ggggg:function(){return leftZeroFill(this.weekYear(),5);},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2);},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4);},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5);},e:function(){return this.weekday();},E:function(){return this.isoWeekday();},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),true);},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),false);},H:function(){return this.hours();},h:function(){return this.hours()%12||12;},m:function(){return this.minutes();},s:function(){return this.seconds();},S:function(){return toInt(this.milliseconds()/100);},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2);},SSS:function(){return leftZeroFill(this.milliseconds(),3);},SSSS:function(){return leftZeroFill(this.milliseconds(),3);},Z:function(){var a=-this.zone(),b='+';if(a<0){a=-a;b='-';}return b+leftZeroFill(toInt(a/60),2)+':'+leftZeroFill(toInt(a)%60,2);},ZZ:function(){var a=-this.zone(),b='+';if(a<0){a=-a;b='-';}return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2);},z:function(){return this.zoneAbbr();},zz:function(){return this.zoneName();},X:function(){return this.unix();},Q:function(){return this.quarter();}},deprecations={},lists=['months','monthsShort','weekdays','weekdaysShort','weekdaysMin'];function dfl(a,b,c){switch(arguments.length){case 2:return a!=null?a:b;case 3:return a!=null?a:b!=null?b:c;default:throw new Error('Implement me');}}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false};}function printMsg(msg){if(moment.suppressDeprecationWarnings===false&&typeof console!=='undefined'&&console.warn){console.warn("Deprecation warning: "+msg);}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(firstTime){printMsg(msg);firstTime=false;}return fn.apply(this,arguments);},fn);}function deprecateSimple(name,msg){if(!deprecations[name]){printMsg(msg);deprecations[name]=true;}}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count);};}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period);};}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+'o']=ordinalizeToken(formatTokenFunctions[i],i);}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Locale(){}function Moment(config,skipOverflow){if(skipOverflow!==false){checkOverflow(config);}copyConfig(this,config);this._d=new Date(+config._d);}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*36e5;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=moment.localeData();this._bubble();}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i];}}if(b.hasOwnProperty('toString')){a.toString=b.toString;}if(b.hasOwnProperty('valueOf')){a.valueOf=b.valueOf;}return a;}function copyConfig(to,from){var i,prop,val;if(typeof from._isAMomentObject!=='undefined'){to._isAMomentObject=from._isAMomentObject;}if(typeof from._i!=='undefined'){to._i=from._i;}if(typeof from._f!=='undefined'){to._f=from._f;}if(typeof from._l!=='undefined'){to._l=from._l;}if(typeof from._strict!=='undefined'){to._strict=from._strict;}if(typeof from._tzm!=='undefined'){to._tzm=from._tzm;}if(typeof from._isUTC!=='undefined'){to._isUTC=from._isUTC;}if(typeof from._offset!=='undefined'){to._offset=from._offset;}if(typeof from._pf!=='undefined'){to._pf=from._pf;}if(typeof from._locale!=='undefined'){to._locale=from._locale;}if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(typeof val!=='undefined'){to[prop]=val;}}}return to;}function absRound(number){if(number<0){return Math.ceil(number);}else{return Math.floor(number);}}function leftZeroFill(number,targetLength,forceSign){var output=''+Math.abs(number),sign=number>=0;while(output.length<targetLength){output='0'+output;}return(sign?(forceSign?'+':''):'-')+output;}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}res.milliseconds=+other-+(base.clone().add(res.months,'M'));return res;}function momentsDifference(base,other){var res;other=makeAs(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}return res;}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period).");tmp=val;val=period;period=tmp;}val=typeof val==='string'?+val:val;dur=moment.duration(val,period);addOrSubtractDurationFromMoment(this,dur,direction);return this;};}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding);}if(days){rawSetter(mom,'Date',rawGetter(mom,'Date')+days*isAdding);}if(months){rawMonthSetter(mom,rawGetter(mom,'Month')+months*isAdding);}if(updateOffset){moment.updateOffset(mom,days||months);}}function isArray(input){return Object.prototype.toString.call(input)==='[object Array]';}function isDate(input){return Object.prototype.toString.call(input)==='[object Date]'||input instanceof Date;}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}return diffs+lengthDiff;}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,'$1');units=unitAliases[units]||camelFunctions[lowered]||lowered;}return units;}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(inputObject.hasOwnProperty(prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}return normalizedInput;}function makeList(field){var count,setter;if(field.indexOf('week')===0){count=7;setter='day';}else if(field.indexOf('month')===0){count=12;setter='month';}else{return;}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if(typeof format==='number'){index=format;format=undefined;}getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||'');};if(index!=null){return getter(index);}else{for(i=0;i<count;i++){results.push(getter(i));}return results;}};}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber);}else{value=Math.ceil(coercedNumber);}}return value;}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate();}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week;}function daysInYear(year){return isLeapYear(year)?366:365;}function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}m._pf.overflow=overflow;}}function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0;}}return m._isValid;}function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break;}j--;}i++;}return null;}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule){try{oldLocale=moment.locale();require('./locale/'+name);moment.locale(oldLocale);}catch(e){}}return locales[name];}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local();}extend(Locale.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==='function'){this[i]=prop;}else{this['_'+i]=prop;}}},_months:'January_February_March_April_May_June_July_August_September_October_November_December'.split('_'),months:function(m){return this._months[m.month()];},_monthsShort:'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),monthsShort:function(m){return this._monthsShort[m.month()];},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[];}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment.utc([2000,i]);regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}if(this._monthsParse[i].test(monthName)){return i;}}},_weekdays:'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),weekdays:function(m){return this._weekdays[m.day()];},_weekdaysShort:'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),weekdaysShort:function(m){return this._weekdaysShort[m.day()];},_weekdaysMin:'Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),weekdaysMin:function(m){return this._weekdaysMin[m.day()];},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[];}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex='^'+this.weekdays(mom,'')+'|^'+this.weekdaysShort(mom,'')+'|^'+this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}if(this._weekdaysParse[i].test(weekdayName)){return i;}}},_longDateFormat:{LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY LT',LLLL:'dddd, MMMM D, YYYY LT'},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1);});this._longDateFormat[key]=output;}return output;},isPM:function(input){return((input+'').toLowerCase().charAt(0)==='p');},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}},_calendar:{sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L'},calendar:function(key,mom){var output=this._calendar[key];return typeof output==='function'?output.apply(mom):output;},_relativeTime:{future:'in %s',past:'%s ago',s:'a few seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',M:'a month',MM:'%d months',y:'a year',yy:'%d years'},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==='function')?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return typeof format==='function'?format(output):format.replace(/%s/i,output);},ordinal:function(number){return this._ordinal.replace('%d',number);},_ordinal:'%d',preparse:function(string){return string;},postformat:function(string){return string;},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;},_week:{dow:0,doy:6},_invalidDate:'Invalid date',invalidDate:function(){return this._invalidDate;}});function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}return input.replace(/\\/g,'');}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}return function(mom){var output='';for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i];}return output;};}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}format=expandFormat(format,m.localeData());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format);}return formatFunctions[format](m);}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}return format;}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case'Q':return parseTokenOneDigit;case'DDDD':return parseTokenThreeDigits;case'YYYY':case'GGGG':case'gggg':return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case'Y':case'G':case'g':return parseTokenSignedNumber;case'YYYYYY':case'YYYYY':case'GGGGG':case'ggggg':return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case'S':if(strict){return parseTokenOneDigit;}case'SS':if(strict){return parseTokenTwoDigits;}case'SSS':if(strict){return parseTokenThreeDigits;}case'DDD':return parseTokenOneToThreeDigits;case'MMM':case'MMMM':case'dd':case'ddd':case'dddd':return parseTokenWord;case'a':case'A':return config._locale._meridiemParse;case'X':return parseTokenTimestampMs;case'Z':case'ZZ':return parseTokenTimezone;case'T':return parseTokenT;case'SSSS':return parseTokenDigits;case'MM':case'DD':case'YY':case'GG':case'gg':case'HH':case'hh':case'mm':case'ss':case'ww':case'WW':return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case'M':case'D':case'd':case'H':case'h':case'm':case's':case'w':case'W':case'e':case'E':return parseTokenOneOrTwoDigits;case'Do':return parseTokenOrdinal;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace('\\','')),'i'));return a;}}function timezoneMinutesFromString(string){string=string||'';var possibleTzMatches=(string.match(parseTokenTimezone)||[]),tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+'').match(parseTimezoneChunker)||['-',0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==='+'?-minutes:minutes;}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case'Q':if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3;}break;case'M':case'MM':if(input!=null){datePartArray[MONTH]=toInt(input)-1;}break;case'MMM':case'MMMM':a=config._locale.monthsParse(input);if(a!=null){datePartArray[MONTH]=a;}else{config._pf.invalidMonth=input;}break;case'D':case'DD':if(input!=null){datePartArray[DATE]=toInt(input);}break;case'Do':if(input!=null){datePartArray[DATE]=toInt(parseInt(input,10));}break;case'DDD':case'DDDD':if(input!=null){config._dayOfYear=toInt(input);}break;case'YY':datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case'YYYY':case'YYYYY':case'YYYYYY':datePartArray[YEAR]=toInt(input);break;case'a':case'A':config._isPm=config._locale.isPM(input);break;case'H':case'HH':case'h':case'hh':datePartArray[HOUR]=toInt(input);break;case'm':case'mm':datePartArray[MINUTE]=toInt(input);break;case's':case'ss':datePartArray[SECOND]=toInt(input);break;case'S':case'SS':case'SSS':case'SSSS':datePartArray[MILLISECOND]=toInt(('0.'+input)*1000);break;case'X':config._d=new Date(parseFloat(input)*1000);break;case'Z':case'ZZ':config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break;case'dd':case'ddd':case'dddd':a=config._locale.weekdaysParse(input);if(a!=null){config._w=config._w||{};config._w['d']=a;}else{config._pf.invalidWeekday=input;}break;case'w':case'ww':case'W':case'WW':case'd':case'e':case'E':token=token.substr(0,1);case'gggg':case'GGGG':case'GGGGG':token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=toInt(input);}break;case'gg':case'GG':config._w=config._w||{};config._w[token]=moment.parseTwoDigitYear(input);}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year);week=dfl(w.W,1);weekday=dfl(w.E,1);}else{dow=config._locale._week.dow;doy=config._locale._week.doy;weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year);week=dfl(w.w,1);if(w.d!=null){weekday=w.d;if(weekday<dow){++week;}}else if(w.e!=null){weekday=w.e+dow;}else{weekday=dow;}}temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return;}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}if(config._dayOfYear){yearToUse=dfl(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true;}date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i];}config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm);}}function dateFromObject(config){var normalizedInput;if(config._d){return;}normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config);}function currentDateArray(config){var now=new Date();if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()];}else{return[now.getFullYear(),now.getMonth(),now.getDate()];}}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601){parseISO(config);return;}config._a=[];config._pf.empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped);}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false;}else{config._pf.unusedTokens.push(token);}addTimeToArrayFromToken(token,parsedInput,config);}else if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token);}}config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string);}if(config._isPm&&config._a[HOUR]<12){config._a[HOUR]+=12;}if(config._isPm===false&&config._a[HOUR]===12){config._a[HOUR]=0;}dateFromConfig(config);checkOverflow(config);}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;});}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return;}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue;}currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}extend(config,bestMoment||tempConfig);}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||' ');break;}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break;}}if(string.match(parseTokenTimezone)){config._f+='Z';}makeDateFromStringAndFormat(config);}else{config._isValid=false;}}function makeDateFromString(config){parseISO(config);if(config._isValid===false){delete config._isValid;moment.createFromInputFallback(config);}}function makeDateFromInput(config){var input=config._i,matched;if(input===undefined){config._d=new Date();}else if(isDate(input)){config._d=new Date(+input);}else if((matched=aspNetJsonRegex.exec(input))!==null){config._d=new Date(+matched[1]);}else if(typeof input==='string'){makeDateFromString(config);}else if(isArray(input)){config._a=input.slice(0);dateFromConfig(config);}else if(typeof(input)==='object'){dateFromObject(config);}else if(typeof(input)==='number'){config._d=new Date(input);}else{moment.createFromInputFallback(config);}}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y);}return date;}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y);}return date;}function parseWeekday(input,locale){if(typeof input==='string'){if(!isNaN(input)){input=parseInt(input,10);}else{input=locale.weekdaysParse(input);if(typeof input!=='number'){return null;}}}return input;}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as('s')),minutes=round(duration.as('m')),hours=round(duration.as('h')),days=round(duration.as('d')),months=round(duration.as('M')),years=round(duration.as('y')),args=seconds<relativeTimeThresholds.s&&['s',seconds]||minutes===1&&['m']||minutes<relativeTimeThresholds.m&&['mm',minutes]||hours===1&&['h']||hours<relativeTimeThresholds.h&&['hh',hours]||days===1&&['d']||days<relativeTimeThresholds.d&&['dd',days]||months===1&&['M']||months<relativeTimeThresholds.M&&['MM',months]||years===1&&['y']||['yy',years];args[2]=withoutSuffix;args[3]=+posNegDuration>0;args[4]=locale;return substituteTimeAgo.apply({},args);}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7;}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7;}adjustedMoment=moment(mom).add(daysToDayOfWeek,'d');return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()};}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;d=d===0?7:d;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear};}function makeMoment(config){var input=config._i,format=config._f;config._locale=config._locale||moment.localeData(config._l);if(input===null||(format===undefined&&input==='')){return moment.invalid({nullInput:true});}if(typeof input==='string'){config._i=input=config._locale.preparse(input);}if(moment.isMoment(input)){return new Moment(input,true);}else if(format){if(isArray(format)){makeDateFromStringAndArray(config);}else{makeDateFromStringAndFormat(config);}}else{makeDateFromInput(config);}return new Moment(config);}moment=function(input,format,locale,strict){var c;if(typeof(locale)==="boolean"){strict=locale;locale=undefined;}c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=locale;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c);};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate('moment construction falls back to js Date. This is '+'discouraged and will be removed in upcoming major '+'release. Please refer to '+'https://github.com/moment/moment/issues/1407 for more info.',function(config){config._d=new Date(config._i);});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}if(!moments.length){return moment();}res=moments[0];for(i=1;i<moments.length;++i){if(moments[i][fn](res)){res=moments[i];}}return res;}moment.min=function(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);};moment.max=function(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);};moment.utc=function(input,format,locale,strict){var c;if(typeof(locale)==="boolean"){strict=locale;locale=undefined;}c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=locale;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc();};moment.unix=function(input){return moment(input*1000);};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso,diffRes;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months};}else if(typeof input==='number'){duration={};if(key){duration[key]=input;}else{duration.milliseconds=input;}}else if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign};}else if(!!(match=isoDurationRegex.exec(input))){sign=(match[1]==='-')?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(moment(duration.from),moment(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}ret=new Duration(duration);if(moment.isDuration(input)&&input.hasOwnProperty('_locale')){ret._locale=input._locale;}return ret;};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.ISO_8601=function(){};moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.relativeTimeThreshold=function(threshold,limit){if(relativeTimeThresholds[threshold]===undefined){return false;}if(limit===undefined){return relativeTimeThresholds[threshold];}relativeTimeThresholds[threshold]=limit;return true;};moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value);});moment.locale=function(key,values){var data;if(key){if(typeof(values)!=="undefined"){data=moment.defineLocale(key,values);}else{data=moment.localeData(key);}if(data){moment.duration._locale=moment._locale=data;}}return moment._locale._abbr;};moment.defineLocale=function(name,values){if(values!==null){values.abbr=name;if(!locales[name]){locales[name]=new Locale();}locales[name].set(values);moment.locale(name);return locales[name];}else{delete locales[name];return null;}};moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key);});moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}if(!key){return moment._locale;}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}key=[key];}return chooseLocale(key);};moment.isMoment=function(obj){return obj instanceof Moment||(obj!=null&&obj.hasOwnProperty('_isAMomentObject'));};moment.isDuration=function(obj){return obj instanceof Duration;};for(i=lists.length-1;i>=0;--i){makeList(lists[i]);}moment.normalizeUnits=function(units){return normalizeUnits(units);};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags);}else{m._pf.userInvalidated=true;}return m;};moment.parseZone=function(){return moment.apply(null,arguments).parseZone();};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};extend(moment.fn=Moment.prototype,{clone:function(){return moment(this);},valueOf:function(){return+this._d+((this._offset||0)*60000);},unix:function(){return Math.floor(+this/1000);},toString:function(){return this.clone().locale('en').format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");},toDate:function(){return this._offset?new Date(+this):this._d;},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){return formatMoment(m,'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}else{return formatMoment(m,'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()];},isValid:function(){return isValid(this);},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0;}return false;},parsingFlags:function(){return extend({},this._pf);},invalidAt:function(){return this._pf.overflow;},utc:function(keepLocalTime){return this.zone(0,keepLocalTime);},local:function(keepLocalTime){if(this._isUTC){this.zone(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.add(this._d.getTimezoneOffset(),'m');}}return this;},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output);},add:createAdder(1,'add'),subtract:createAdder(-1,'subtract'),diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(this.zone()-that.zone())*6e4,diff,output;units=normalizeUnits(units);if(units==='year'||units==='month'){diff=(this.daysInMonth()+that.daysInMonth())*432e5;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf('month'))-(that-moment(that).startOf('month')))/diff;output-=((this.zone()-moment(this).startOf('month').zone())-(that.zone()-moment(that).startOf('month').zone()))*6e4/diff;if(units==='year'){output=output/12;}}else{diff=(this-that);output=units==='second'?diff/1e3:units==='minute'?diff/6e4:units==='hour'?diff/36e5:units==='day'?(diff-zoneDiff)/864e5:units==='week'?(diff-zoneDiff)/6048e5:diff;}return asFloat?output:absRound(output);},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix);},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf('day'),diff=this.diff(sod,'days',true),format=diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';return this.format(this.localeData().calendar(format,this));},isLeapYear:function(){return isLeapYear(this.year());},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone());},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}},month:makeAccessor('Month',true),startOf:function(units){units=normalizeUnits(units);switch(units){case'year':this.month(0);case'quarter':case'month':this.date(1);case'week':case'isoWeek':case'day':this.hours(0);case'hour':this.minutes(0);case'minute':this.seconds(0);case'second':this.milliseconds(0);}if(units==='week'){this.weekday(0);}else if(units==='isoWeek'){this.isoWeekday(1);}if(units==='quarter'){this.month(Math.floor(this.month()/3)*3);}return this;},endOf:function(units){units=normalizeUnits(units);return this.startOf(units).add(1,(units==='isoWeek'?'week':units)).subtract(1,'ms');},isAfter:function(input,units){units=typeof units!=='undefined'?units:'millisecond';return+this.clone().startOf(units)>+moment(input).startOf(units);},isBefore:function(input,units){units=typeof units!=='undefined'?units:'millisecond';return+this.clone().startOf(units)<+moment(input).startOf(units);},isSame:function(input,units){units=units||'ms';return+this.clone().startOf(units)===+makeAs(input,this).startOf(units);},min:deprecate('moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',function(other){other=moment.apply(null,arguments);return other<this?this:other;}),max:deprecate('moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',function(other){other=moment.apply(null,arguments);return other>this?this:other;}),zone:function(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(input!=null){if(typeof input==='string'){input=timezoneMinutesFromString(input);}if(Math.abs(input)<16){input=input*60;}if(!this._isUTC&&keepLocalTime){localAdjust=this._d.getTimezoneOffset();}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.subtract(localAdjust,'m');}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null;}}}else{return this._isUTC?offset:this._d.getTimezoneOffset();}return this;},zoneAbbr:function(){return this._isUTC?'UTC':'';},zoneName:function(){return this._isUTC?'Coordinated Universal Time':'';},parseZone:function(){if(this._tzm){this.zone(this._tzm);}else if(typeof this._i==='string'){this.zone(this._i);}return this;},hasAlignedHourOffset:function(input){if(!input){input=0;}else{input=moment(input).zone();}return(this.zone()-input)%60===0;},daysInMonth:function(){return daysInMonth(this.year(),this.month());},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf('day')-moment(this).startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add((input-dayOfYear),'d');},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3);},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return input==null?year:this.add((input-year),'y');},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add((input-year),'y');},week:function(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7);},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4);},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);},get:function(units){units=normalizeUnits(units);return this[units]();},set:function(units,value){units=normalizeUnits(units);if(typeof this[units]==='function'){this[units](value);}return this;},locale:function(key){if(key===undefined){return this._locale._abbr;}else{this._locale=moment.localeData(key);return this;}},lang:deprecate("moment().lang() is deprecated. Use moment().localeData() instead.",function(key){return this.localeData(key);}),localeData:function(){return this._locale;}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==='string'){value=mom.localeData().monthsParse(value);if(typeof value!=='number'){return mom;}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d['set'+(mom._isUTC?'UTC':'')+'Month'](value,dayOfMonth);return mom;}function rawGetter(mom,unit){return mom._d['get'+(mom._isUTC?'UTC':'')+unit]();}function rawSetter(mom,unit,value){if(unit==='Month'){return rawMonthSetter(mom,value);}else{return mom._d['set'+(mom._isUTC?'UTC':'')+unit](value);}}function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this;}else{return rawGetter(this,unit);}};}moment.fn.millisecond=moment.fn.milliseconds=makeAccessor('Milliseconds',false);moment.fn.second=moment.fn.seconds=makeAccessor('Seconds',false);moment.fn.minute=moment.fn.minutes=makeAccessor('Minutes',false);moment.fn.hour=moment.fn.hours=makeAccessor('Hours',true);moment.fn.date=makeAccessor('Date',true);moment.fn.dates=deprecate('dates accessor is deprecated. Use date instead.',makeAccessor('Date',true));moment.fn.year=makeAccessor('FullYear',true);moment.fn.years=deprecate('years accessor is deprecated. Use year instead.',makeAccessor('FullYear',true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;function daysToYears(days){return days*400/146097;}function yearsToDays(years){return years*146097/400;}extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years=0;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);years=absRound(daysToYears(days));days-=absRound(yearsToDays(years));months+=absRound(days/30);days%=30;years+=absRound(months/12);months%=12;data.days=days;data.months=months;data.years=years;},abs:function(){this._milliseconds=Math.abs(this._milliseconds);this._days=Math.abs(this._days);this._months=Math.abs(this._months);this._data.milliseconds=Math.abs(this._data.milliseconds);this._data.seconds=Math.abs(this._data.seconds);this._data.minutes=Math.abs(this._data.minutes);this._data.hours=Math.abs(this._data.hours);this._data.months=Math.abs(this._data.months);this._data.years=Math.abs(this._data.years);return this;},weeks:function(){return absRound(this.days()/7);},valueOf:function(){return this._milliseconds+this._days*864e5+(this._months%12)*2592e6+toInt(this._months/12)*31536e6;},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());if(withSuffix){output=this.localeData().pastFuture(+this,output);}return this.localeData().postformat(output);},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this;},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this;},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+'s']();},as:function(units){var days,months;units=normalizeUnits(units);days=this._days+this._milliseconds/864e5;if(units==='month'||units==='year'){months=this._months+daysToYears(days)*12;return units==='month'?months:months/12;}else{days+=yearsToDays(this._months/12);switch(units){case'week':return days/7;case'day':return days;case'hour':return days*24;case'minute':return days*24*60;case'second':return days*24*60*60;case'millisecond':return days*24*60*60*1000;default:throw new Error('Unknown unit '+units);}}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead "+"(notice the capitals)",function(){return this.toISOString();}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return'P0D';}return(this.asSeconds()<0?'-':'')+'P'+(years?years+'Y':'')+(months?months+'M':'')+(days?days+'D':'')+((hours||minutes||seconds)?'T':'')+(hours?hours+'H':'')+(minutes?minutes+'M':'')+(seconds?seconds+'S':'');},localeData:function(){return this._locale;}});function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name];};}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationGetter(i.toLowerCase());}}moment.duration.fn.asMilliseconds=function(){return this.as('ms');};moment.duration.fn.asSeconds=function(){return this.as('s');};moment.duration.fn.asMinutes=function(){return this.as('m');};moment.duration.fn.asHours=function(){return this.as('h');};moment.duration.fn.asDays=function(){return this.as('d');};moment.duration.fn.asWeeks=function(){return this.as('weeks');};moment.duration.fn.asMonths=function(){return this.as('M');};moment.duration.fn.asYears=function(){return this.as('y');};moment.locale('en',{ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';return number+output;}});function makeGlobal(shouldDeprecate){if(typeof ender!=='undefined'){return;}oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.ot_moment=deprecate('Accessing Moment through the global scope is '+'deprecated, and will be removed in an upcoming '+'release.',moment);}else{globalScope.ot_moment=moment;}}if(hasModule){module.exports=moment;}else if(typeof define==='function'&&define.amd){define('moment',function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===true){globalScope.ot_moment=oldGlobalMoment;}return moment;});makeGlobal(true);}else{makeGlobal();}}).call(this);(function(factory){if(typeof define==='function'&&define.amd){define(['moment'],factory);}else if(typeof exports==='object'){module.exports=factory(require('../moment'));}else{factory(window.ot_moment);}}(function(moment){function processRelativeTime(number,withoutSuffix,key,isFuture){var format={'m':['eine Minute','einer Minute'],'h':['eine Stunde','einer Stunde'],'d':['ein Tag','einem Tag'],'dd':[number+' Tage',number+' Tagen'],'M':['ein Monat','einem Monat'],'MM':[number+' Monate',number+' Monaten'],'y':['ein Jahr','einem Jahr'],'yy':[number+' Jahre',number+' Jahren']};return withoutSuffix?format[key][0]:format[key][1];}return moment.defineLocale('de',{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:'[Morgen um] LT',nextWeek:'dddd [um] LT',lastDay:'[Gestern um] LT',lastWeek:'[letzten] dddd [um] LT'},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:processRelativeTime,mm:"%d Minuten",h:processRelativeTime,hh:"%d Stunden",d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},ordinal:'%d.',week:{dow:1,doy:4}});}));(function(factory){if(typeof define==='function'&&define.amd){define(['moment'],factory);}else if(typeof exports==='object'){module.exports=factory(require('../moment'));}else{factory(window.ot_moment);}}(function(moment){var monthsShortDot="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),monthsShort="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");return moment.defineLocale('es',{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(m,format){if(/-MMM-/.test(format)){return monthsShort[m.month()];}else{return monthsShortDot[m.month()];}},weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [del] YYYY",LLL:"D [de] MMMM [del] YYYY LT",LLLL:"dddd, D [de] MMMM [del] YYYY LT"},calendar:{sameDay:function(){return'[hoy a la'+((this.hours()!==1)?'s':'')+'] LT';},nextDay:function(){return'[mañana a la'+((this.hours()!==1)?'s':'')+'] LT';},nextWeek:function(){return'dddd [a la'+((this.hours()!==1)?'s':'')+'] LT';},lastDay:function(){return'[ayer a la'+((this.hours()!==1)?'s':'')+'] LT';},lastWeek:function(){return'[el] dddd [pasado a la'+((this.hours()!==1)?'s':'')+'] LT';},sameElse:'L'},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:'%dº',week:{dow:1,doy:4}});}));(function(factory){if(typeof define==='function'&&define.amd){define(['moment'],factory);}else if(typeof exports==='object'){module.exports=factory(require('../moment'));}else{factory(window.ot_moment);}}(function(moment){return moment.defineLocale('fr',{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:'[Demain à] LT',nextWeek:'dddd [à] LT',lastDay:'[Hier à] LT',lastWeek:'dddd [dernier à] LT',sameElse:'L'},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(number){return number+(number===1?'er':'');},week:{dow:1,doy:4}});}));(function(factory){if(typeof define==='function'&&define.amd){define(['moment'],factory);}else if(typeof exports==='object'){module.exports=factory(require('../moment'));}else{factory(window.ot_moment);}}(function(moment){return moment.defineLocale('ja',{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(hour,minute,isLower){if(hour<12){return"午前";}else{return"午後";}},calendar:{sameDay:'[今日] LT',nextDay:'[明日] LT',nextWeek:'[来週]dddd LT',lastDay:'[昨日] LT',lastWeek:'[前週]dddd LT',sameElse:'L'},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}});}));(function(factory){if(typeof define==='function'&&define.amd){define(['moment'],factory);}else if(typeof exports==='object'){module.exports=factory(require('../moment'));}else{factory(window.ot_moment);}}(function(moment){var monthsShortWithDots="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsShortWithoutDots="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return moment.defineLocale('nl',{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(m,format){if(/-MMM-/.test(format)){return monthsShortWithoutDots[m.month()];}else{return monthsShortWithDots[m.month()];}},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:'[vandaag om] LT',nextDay:'[morgen om] LT',nextWeek:'dddd [om] LT',lastDay:'[gisteren om] LT',lastWeek:'[afgelopen] dddd [om] LT',sameElse:'L'},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},ordinal:function(number){return number+((number===1||number===8||number>=20)?'ste':'de');},week:{dow:1,doy:4}});}));(function(factory){if(typeof define==='function'&&define.amd)define('picker',['jquery'],factory)
else this.Picker=factory(jQuery)}(function($){var $window=$(window)
var $document=$(document)
var $html=$(document.documentElement)
function PickerConstructor(ELEMENT,NAME,COMPONENT,OPTIONS){if(!ELEMENT)return PickerConstructor
var
IS_DEFAULT_THEME=false,STATE={id:ELEMENT.id||'P'+Math.abs(~~(Math.random()*new Date()))},SETTINGS=COMPONENT?$.extend(true,{},COMPONENT.defaults,OPTIONS):OPTIONS||{},CLASSES=$.extend({},PickerConstructor.klasses(),SETTINGS.klass),$ELEMENT=$(ELEMENT),PickerInstance=function(){return this.start()},P=PickerInstance.prototype={constructor:PickerInstance,$node:$ELEMENT,start:function(){if(STATE&&STATE.start)return P
STATE.methods={}
STATE.start=true
STATE.open=false
STATE.type=ELEMENT.type
ELEMENT.autofocus=ELEMENT==document.activeElement
ELEMENT.type='text'
ELEMENT.readOnly=!SETTINGS.editable
ELEMENT.id=ELEMENT.id||STATE.id
P.component=new COMPONENT(P,SETTINGS)
P.$root=$(PickerConstructor._.node('div',createWrappedComponent(),CLASSES.picker,'id="'+ELEMENT.id+'_root"'))
prepareElementRoot()
if(SETTINGS.formatSubmit){prepareElementHidden()}prepareElement()
if(SETTINGS.container)$(SETTINGS.container).append(P.$root)
else $ELEMENT.after(P.$root)
P.on({start:P.component.onStart,render:P.component.onRender,stop:P.component.onStop,open:P.component.onOpen,close:P.component.onClose,set:P.component.onSet}).on({start:SETTINGS.onStart,render:SETTINGS.onRender,stop:SETTINGS.onStop,open:SETTINGS.onOpen,close:SETTINGS.onClose,set:SETTINGS.onSet})
IS_DEFAULT_THEME=isUsingDefaultTheme(P.$root.children()[0])
if(ELEMENT.autofocus){P.open()}return P.trigger('start').trigger('render')},render:function(entireComponent){if(entireComponent)P.$root.html(createWrappedComponent())
else P.$root.find('.'+CLASSES.box).html(P.component.nodes(STATE.open))
return P.trigger('render')},stop:function(){if(!STATE.start)return P
P.close()
if(P._hidden){P._hidden.parentNode.removeChild(P._hidden)}P.$root.remove()
$ELEMENT.removeClass(CLASSES.input).removeData(NAME)
setTimeout(function(){$ELEMENT.off('.'+STATE.id)},0)
ELEMENT.type=STATE.type
ELEMENT.readOnly=false
P.trigger('stop')
STATE.methods={}
STATE.start=false
return P},open:function(dontGiveFocus){if(STATE.open)return P
$ELEMENT.addClass(CLASSES.active)
aria(ELEMENT,'expanded',true)
setTimeout(function(){P.$root.addClass(CLASSES.opened)
aria(P.$root[0],'hidden',false)},0)
if(dontGiveFocus!==false){STATE.open=true
if(IS_DEFAULT_THEME){$html.css('overflow','hidden').css('padding-right','+='+getScrollbarWidth())}$ELEMENT.trigger('focus')
$document.on('click.'+STATE.id+' focusin.'+STATE.id+' touchend.'+STATE.id,function(event){var target=event.target
if(target!=ELEMENT&&target!=document&&event.which!=3){P.close(target===P.$root.children()[0])}}).on('keydown.'+STATE.id,function(event){var
keycode=event.keyCode,keycodeToMove=P.component.key[keycode],target=event.target
if(keycode==27){P.close(true)}else if(target==ELEMENT&&(keycodeToMove||keycode==13)){event.preventDefault()
if(keycodeToMove){PickerConstructor._.trigger(P.component.key.go,P,[PickerConstructor._.trigger(keycodeToMove)])}else if(!P.$root.find('.'+CLASSES.highlighted).hasClass(CLASSES.disabled)){P.set('select',P.component.item.highlight).close()}}else if($.contains(P.$root[0],target)&&keycode==13){event.preventDefault()
target.click()}})}return P.trigger('open')},close:function(giveFocus){if(OT.Widget.theme==='tall')return;if(giveFocus){$ELEMENT.off('focus.'+STATE.id).trigger('focus')
setTimeout(function(){$ELEMENT.on('focus.'+STATE.id,focusToOpen)},0)}$ELEMENT.removeClass(CLASSES.active)
aria(ELEMENT,'expanded',false)
setTimeout(function(){P.$root.removeClass(CLASSES.opened+' '+CLASSES.focused)
aria(P.$root[0],'hidden',true)},0)
if(!STATE.open)return P
STATE.open=false
if(IS_DEFAULT_THEME){$html.css('overflow','').css('padding-right','-='+getScrollbarWidth())}$document.off('.'+STATE.id)
return P.trigger('close')},clear:function(){return P.set('clear')},set:function(thing,value,options){var thingItem,thingValue,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{}
options=thingIsObject&&$.isPlainObject(value)?value:options||{}
if(thing){if(!thingIsObject){thingObject[thing]=value}for(thingItem in thingObject){thingValue=thingObject[thingItem]
if(thingItem in P.component.item){if(thingValue===undefined)thingValue=null
P.component.set(thingItem,thingValue,options)}if(thingItem=='select'||thingItem=='clear'){$ELEMENT.val(thingItem=='clear'?'':P.get(thingItem,SETTINGS.format)).trigger('change')}}P.render()}return options.muted?P:P.trigger('set',thingObject)},get:function(thing,format){thing=thing||'value'
if(STATE[thing]!=null){return STATE[thing]}if(thing=='value'){return ELEMENT.value}if(thing in P.component.item){if(typeof format=='string'){var thingValue=P.component.get(thing)
return thingValue?PickerConstructor._.trigger(P.component.formats.toString,P.component,[format,thingValue]):''}return P.component.get(thing)}},on:function(thing,method){var thingName,thingMethod,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{}
if(thing){if(!thingIsObject){thingObject[thing]=method}for(thingName in thingObject){thingMethod=thingObject[thingName]
STATE.methods[thingName]=STATE.methods[thingName]||[]
STATE.methods[thingName].push(thingMethod)}}return P},off:function(){var i,thingName,names=arguments;for(i=0,namesCount=names.length;i<namesCount;i+=1){thingName=names[i]
if(thingName in STATE.methods){delete STATE.methods[thingName]}}return P},trigger:function(name,data){var methodList=STATE.methods[name]
if(methodList){methodList.map(function(method){PickerConstructor._.trigger(method,P,[data])})}return P}}
function createWrappedComponent(){return PickerConstructor._.node('div',PickerConstructor._.node('div',PickerConstructor._.node('div',PickerConstructor._.node('div',P.component.nodes(STATE.open),CLASSES.box),CLASSES.wrap),CLASSES.frame),CLASSES.holder)}function prepareElement(){$ELEMENT.data(NAME,P).addClass(CLASSES.input).val($ELEMENT.data('value')?P.get('select',SETTINGS.format):ELEMENT.value).on('focus.'+STATE.id+' click.'+STATE.id,focusToOpen)
if(!SETTINGS.editable){$ELEMENT.on('keydown.'+STATE.id,function(event){var keycode=event.keyCode,isKeycodeDelete=/^(8|46)$/.test(keycode)
if(keycode==27){P.close()
return false}if(keycode==32||isKeycodeDelete||!STATE.open&&P.component.key[keycode]){event.preventDefault()
event.stopPropagation()
if(isKeycodeDelete){P.clear().close()}else{P.open()}}})}aria(ELEMENT,{haspopup:true,expanded:false,readonly:false,owns:ELEMENT.id+'_root'+(P._hidden?' '+P._hidden.id:'')})}function prepareElementRoot(){P.$root.on({focusin:function(event){P.$root.removeClass(CLASSES.focused)
event.stopPropagation()},'touchend mousedown click':function(event){var target=event.target
if(target!=P.$root.children()[0]){event.stopPropagation()
if((event.type=='mousedown'||event.type=='touchend')&&!$(target).is(':input')&&target.nodeName!='OPTION'){event.preventDefault()
ELEMENT.focus()}}}}).on('click touchend','[data-pick], [data-nav], [data-clear]',function(){var $target=$(this),targetData=$target.data(),targetDisabled=$target.hasClass(CLASSES.navDisabled)||$target.hasClass(CLASSES.disabled),activeElement=document.activeElement
activeElement=activeElement&&(activeElement.type||activeElement.href)&&activeElement
if(targetDisabled||activeElement&&!$.contains(P.$root[0],activeElement)){ELEMENT.focus()}if(targetData.nav&&!targetDisabled){P.set('highlight',P.component.item.highlight,{nav:targetData.nav})}else if(PickerConstructor._.isInteger(targetData.pick)&&!targetDisabled){P.set('select',targetData.pick).close(true)}else if(targetData.clear){P.clear().close(true)}})
aria(P.$root[0],'hidden',true)}function prepareElementHidden(){var id,name
if(SETTINGS.hiddenName===true){id=ELEMENT.name+'_hidden'
name=ELEMENT.name
ELEMENT.name=''}else{name=[typeof SETTINGS.hiddenPrefix=='string'?SETTINGS.hiddenPrefix:'',typeof SETTINGS.hiddenSuffix=='string'?SETTINGS.hiddenSuffix:'_submit']
name=id=name[0]+ELEMENT.name+name[1]}P._hidden=$('<input '+'type=hidden '+'name="'+name+'"'+'id="'+id+'"'+($ELEMENT.data('value')||ELEMENT.value?' value="'+P.get('select',SETTINGS.formatSubmit)+'"':'')+'>')[0]
$ELEMENT.on('change.'+STATE.id,function(){P._hidden.value=ELEMENT.value?P.get('select',SETTINGS.formatSubmit):''}).after(P._hidden)}function focusToOpen(event){event.stopPropagation()
if(event.type=='focus'){P.$root.addClass(CLASSES.focused)}P.open()}return new PickerInstance()}PickerConstructor.klasses=function(prefix){prefix=prefix||'picker'
return{picker:prefix,opened:prefix+'--opened',focused:prefix+'--focused',input:prefix+'__input',active:prefix+'__input--active',holder:prefix+'__holder',frame:prefix+'__frame',wrap:prefix+'__wrap',box:prefix+'__box'}}
function isUsingDefaultTheme(element){var theme,prop='position'
if(element.currentStyle){theme=element.currentStyle[prop]}else if(window.getComputedStyle){theme=getComputedStyle(element)[prop]}return theme=='fixed'}function getScrollbarWidth(){if($html.height()<=$window.height()){return 0}var $outer=$('<div style="visibility:hidden;width:100px" />').appendTo('body')
var widthWithoutScroll=$outer[0].offsetWidth
$outer.css('overflow','scroll')
var $inner=$('<div style="width:100%" />').appendTo($outer)
var widthWithScroll=$inner[0].offsetWidth
$outer.remove()
return widthWithoutScroll-widthWithScroll}PickerConstructor._={group:function(groupObject){var
loopObjectScope,nodesList='',counter=PickerConstructor._.trigger(groupObject.min,groupObject)
for(;counter<=PickerConstructor._.trigger(groupObject.max,groupObject,[counter]);counter+=groupObject.i){loopObjectScope=PickerConstructor._.trigger(groupObject.item,groupObject,[counter])
nodesList+=PickerConstructor._.node(groupObject.node,loopObjectScope[0],loopObjectScope[1],loopObjectScope[2])}return nodesList},node:function(wrapper,item,klass,attribute){if(!item)return''
item=$.isArray(item)?item.join(''):item
klass=klass?' class="'+klass+'"':''
attribute=attribute?' '+attribute:''
return'<'+wrapper+klass+attribute+'>'+item+'</'+wrapper+'>'},lead:function(number){return(number<10?'0':'')+number},trigger:function(callback,scope,args){return typeof callback=='function'?callback.apply(scope,args||[]):callback},digits:function(string){return(/\d/).test(string[1])?2:1},isDate:function(value){return{}.toString.call(value).indexOf('Date')>-1&&this.isInteger(value.getDate())},isInteger:function(value){return{}.toString.call(value).indexOf('Number')>-1&&value%1===0},ariaAttr:ariaAttr}
PickerConstructor.extend=function(name,Component){$.fn[name]=function(options,action){var componentData=this.data(name)
if(options=='picker'){return componentData}if(componentData&&typeof options=='string'){return PickerConstructor._.trigger(componentData[options],componentData,[action])}return this.each(function(){var $this=$(this)
if(!$this.data(name)){new PickerConstructor(this,name,Component,options)}})}
$.fn[name].defaults=Component.defaults}
function aria(element,attribute,value){if($.isPlainObject(attribute)){for(var key in attribute){ariaSet(element,key,attribute[key])}}else{ariaSet(element,attribute,value)}}function ariaSet(element,attribute,value){element.setAttribute((attribute=='role'?'':'aria-')+attribute,value)}function ariaAttr(attribute,data){if(!$.isPlainObject(attribute)){attribute={attribute:data}}data=''
for(var key in attribute){var attr=(key=='role'?'':'aria-')+key,attrVal=attribute[key]
data+=attrVal==null?'':attr+'="'+attribute[key]+'"'}return data}return PickerConstructor}));(function(factory){if(typeof define=='function'&&define.amd)define(['picker','jquery'],factory)
else factory(Picker,jQuery)}(function(Picker,$){var DAYS_IN_WEEK=7,WEEKS_IN_CALENDAR=6,_=Picker._
function DatePicker(picker,settings){var calendar=this,elementValue=picker.$node[0].value,elementDataValue=picker.$node.data('value'),valueString=elementDataValue||elementValue,formatString=elementDataValue?settings.formatSubmit:settings.format,isRTL=function(){return getComputedStyle(picker.$root[0]).direction==='rtl'}
calendar.settings=settings
calendar.$node=picker.$node
calendar.queue={min:'measure create',max:'measure create',now:'now create',select:'parse create validate',highlight:'parse navigate create validate',view:'parse create validate viewset',disable:'deactivate',enable:'activate'}
calendar.item={}
calendar.item.clear=null
calendar.item.disable=(settings.disable||[]).slice(0)
calendar.item.enable=-(function(collectionDisabled){return collectionDisabled[0]===true?collectionDisabled.shift():-1})(calendar.item.disable)
calendar.set('min',settings.min).set('max',settings.max).set('now')
if(valueString){calendar.set('select',valueString,{format:formatString})}else{calendar.set('select',null).set('highlight',calendar.item.now)}calendar.key={40:7,38:-7,39:function(){return isRTL()?-1:1},37:function(){return isRTL()?1:-1},go:function(timeChange){var highlightedObject=calendar.item.highlight,targetDate=new Date(highlightedObject.year,highlightedObject.month,highlightedObject.date+timeChange)
calendar.set('highlight',[targetDate.getFullYear(),targetDate.getMonth(),targetDate.getDate()],{interval:timeChange})
this.render()}}
picker.on('render',function(){picker.$root.find('.'+settings.klass.selectMonth).on('change',function(){var value=this.value
if(value){picker.set('highlight',[picker.get('view').year,value,picker.get('highlight').date])
picker.$root.find('.'+settings.klass.selectMonth).trigger('focus')}})
picker.$root.find('.'+settings.klass.selectYear).on('change',function(){var value=this.value
if(value){picker.set('highlight',[value,picker.get('view').month,picker.get('highlight').date])
picker.$root.find('.'+settings.klass.selectYear).trigger('focus')}})}).on('open',function(){picker.$root.find('button, select').attr('disabled',false)}).on('close',function(){picker.$root.find('button, select').attr('disabled',true)})}DatePicker.prototype.set=function(type,value,options){var calendar=this,calendarItem=calendar.item
if(value===null){if(type=='clear')type='select'
calendarItem[type]=value
return calendar}calendarItem[(type=='enable'?'disable':type=='flip'?'enable':type)]=calendar.queue[type].split(' ').map(function(method){value=calendar[method](type,value,options)
return value}).pop()
if(type=='select'){calendar.set('highlight',calendarItem.select,options)}else if(type=='highlight'){calendar.set('view',calendarItem.highlight,options)}else if(type.match(/^(flip|min|max|disable|enable)$/)){if(calendarItem.select&&calendar.disabled(calendarItem.select)){calendar.set('select',calendarItem.select,options)}if(calendarItem.highlight&&calendar.disabled(calendarItem.highlight)){calendar.set('highlight',calendarItem.highlight,options)}}return calendar}
DatePicker.prototype.get=function(type){return this.item[type]}
DatePicker.prototype.create=function(type,value,options){var isInfiniteValue,calendar=this
value=value===undefined?type:value
if(value==-Infinity||value==Infinity){isInfiniteValue=value}else if($.isPlainObject(value)&&_.isInteger(value.pick)){value=value.obj}else if($.isArray(value)){value=new Date(value[0],value[1],value[2])
value=_.isDate(value)?value:calendar.create().obj}else if(_.isInteger(value)||_.isDate(value)){value=calendar.normalize(new Date(value),options)}else{value=calendar.now(type,value,options)}return{year:isInfiniteValue||value.getFullYear(),month:isInfiniteValue||value.getMonth(),date:isInfiniteValue||value.getDate(),day:isInfiniteValue||value.getDay(),obj:isInfiniteValue||value,pick:isInfiniteValue||value.getTime()}}
DatePicker.prototype.createRange=function(from,to){var calendar=this,createDate=function(date){if(date===true||$.isArray(date)||_.isDate(date)){return calendar.create(date)}return date}
if(!_.isInteger(from)){from=createDate(from)}if(!_.isInteger(to)){to=createDate(to)}if(_.isInteger(from)&&$.isPlainObject(to)){from=[to.year,to.month,to.date+from];}else if(_.isInteger(to)&&$.isPlainObject(from)){to=[from.year,from.month,from.date+to];}return{from:createDate(from),to:createDate(to)}}
DatePicker.prototype.withinRange=function(range,dateUnit){range=this.createRange(range.from,range.to)
return dateUnit.pick>=range.from.pick&&dateUnit.pick<=range.to.pick}
DatePicker.prototype.overlapRanges=function(one,two){var calendar=this
one=calendar.createRange(one.from,one.to)
two=calendar.createRange(two.from,two.to)
return calendar.withinRange(one,two.from)||calendar.withinRange(one,two.to)||calendar.withinRange(two,one.from)||calendar.withinRange(two,one.to)}
DatePicker.prototype.now=function(type,value,options){value=new Date()
if(options&&options.rel){value.setDate(value.getDate()+options.rel)}return this.normalize(value,options)}
DatePicker.prototype.navigate=function(type,value,options){var targetDateObject,targetYear,targetMonth,targetDate,isTargetArray=$.isArray(value),isTargetObject=$.isPlainObject(value),viewsetObject=this.item.view
if(isTargetArray||isTargetObject){if(isTargetObject){targetYear=value.year
targetMonth=value.month
targetDate=value.date}else{targetYear=+value[0]
targetMonth=+value[1]
targetDate=+value[2]}if(options&&options.nav&&viewsetObject&&viewsetObject.month!==targetMonth){targetYear=viewsetObject.year
targetMonth=viewsetObject.month}targetDateObject=new Date(targetYear,targetMonth+(options&&options.nav?options.nav:0),1)
targetYear=targetDateObject.getFullYear()
targetMonth=targetDateObject.getMonth()
while(new Date(targetYear,targetMonth,targetDate).getMonth()!==targetMonth){targetDate-=1}value=[targetYear,targetMonth,targetDate]}return value}
DatePicker.prototype.normalize=function(value){value.setHours(0,0,0,0)
return value}
DatePicker.prototype.measure=function(type,value){var calendar=this
if(!value){value=type=='min'?-Infinity:Infinity}else if(_.isInteger(value)){value=calendar.now(type,value,{rel:value})}return value}
DatePicker.prototype.viewset=function(type,dateObject){return this.create([dateObject.year,dateObject.month,1])}
DatePicker.prototype.validate=function(type,dateObject,options){var calendar=this,originalDateObject=dateObject,interval=options&&options.interval?options.interval:1,isFlippedBase=calendar.item.enable===-1,hasEnabledBeforeTarget,hasEnabledAfterTarget,minLimitObject=calendar.item.min,maxLimitObject=calendar.item.max,reachedMin,reachedMax,hasEnabledWeekdays=isFlippedBase&&calendar.item.disable.filter(function(value){if($.isArray(value)){var dateTime=calendar.create(value).pick
if(dateTime<dateObject.pick)hasEnabledBeforeTarget=true
else if(dateTime>dateObject.pick)hasEnabledAfterTarget=true}return _.isInteger(value)}).length
if(!options||!options.nav)if((!isFlippedBase&&calendar.disabled(dateObject))||(isFlippedBase&&calendar.disabled(dateObject)&&(hasEnabledWeekdays||hasEnabledBeforeTarget||hasEnabledAfterTarget))||(!isFlippedBase&&(dateObject.pick<=minLimitObject.pick||dateObject.pick>=maxLimitObject.pick))){if(isFlippedBase&&!hasEnabledWeekdays&&((!hasEnabledAfterTarget&&interval>0)||(!hasEnabledBeforeTarget&&interval<0))){interval*=-1}while(calendar.disabled(dateObject)){if(Math.abs(interval)>1&&(dateObject.month<originalDateObject.month||dateObject.month>originalDateObject.month)){dateObject=originalDateObject
interval=interval>0?1:-1}if(dateObject.pick<=minLimitObject.pick){reachedMin=true
interval=1
dateObject=calendar.create([minLimitObject.year,minLimitObject.month,minLimitObject.date+(dateObject.pick===minLimitObject.pick?0:-1)])}else if(dateObject.pick>=maxLimitObject.pick){reachedMax=true
interval=-1
dateObject=calendar.create([maxLimitObject.year,maxLimitObject.month,maxLimitObject.date+(dateObject.pick===maxLimitObject.pick?0:1)])}if(reachedMin&&reachedMax){break}dateObject=calendar.create([dateObject.year,dateObject.month,dateObject.date+interval])}}return dateObject}
DatePicker.prototype.disabled=function(dateToVerify){var
calendar=this,isDisabledMatch=calendar.item.disable.filter(function(dateToDisable){if(_.isInteger(dateToDisable)){return dateToVerify.day===(calendar.settings.firstDay?dateToDisable:dateToDisable-1)%7}if($.isArray(dateToDisable)||_.isDate(dateToDisable)){return dateToVerify.pick===calendar.create(dateToDisable).pick}if($.isPlainObject(dateToDisable)){return calendar.withinRange(dateToDisable,dateToVerify)}})
isDisabledMatch=isDisabledMatch.length&&!isDisabledMatch.filter(function(dateToDisable){return $.isArray(dateToDisable)&&dateToDisable[3]=='inverted'||$.isPlainObject(dateToDisable)&&dateToDisable.inverted}).length
return calendar.item.enable===-1?!isDisabledMatch:isDisabledMatch||dateToVerify.pick<calendar.item.min.pick||dateToVerify.pick>calendar.item.max.pick}
DatePicker.prototype.parse=function(type,value,options){var calendar=this,parsingObject={}
if(!value||typeof value!='string'){return value}if(!(options&&options.format)){options=options||{}
options.format=calendar.settings.format}calendar.formats.toArray(options.format).map(function(label){var
formattingLabel=calendar.formats[label],formatLength=formattingLabel?_.trigger(formattingLabel,calendar,[value,parsingObject]):label.replace(/^!/,'').length
if(formattingLabel){parsingObject[label]=value.substr(0,formatLength)}value=value.substr(formatLength)})
return[parsingObject.yyyy||parsingObject.yy,+(parsingObject.mm||parsingObject.m)-1,parsingObject.dd||parsingObject.d]}
DatePicker.prototype.formats=(function(){function getWordLengthFromCollection(string,collection,dateObject){var word=string.match(/\w+/)[0]
if(!dateObject.mm&&!dateObject.m){dateObject.m=collection.indexOf(word)+1}return word.length}function getFirstWordLength(string){return string.match(/\w+/)[0].length}return{d:function(string,dateObject){return string?_.digits(string):dateObject.date},dd:function(string,dateObject){return string?2:_.lead(dateObject.date)},ddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysShort[dateObject.day]},dddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysFull[dateObject.day]},m:function(string,dateObject){return string?_.digits(string):dateObject.month+1},mm:function(string,dateObject){return string?2:_.lead(dateObject.month+1)},mmm:function(string,dateObject){var collection=this.settings.monthsShort
return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},mmmm:function(string,dateObject){var collection=this.settings.monthsFull
return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},yy:function(string,dateObject){return string?2:(''+dateObject.year).slice(2)},yyyy:function(string,dateObject){return string?4:dateObject.year},toArray:function(formatString){return formatString.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(formatString,itemObject){var calendar=this
return calendar.formats.toArray(formatString).map(function(label){return _.trigger(calendar.formats[label],calendar,[0,itemObject])||label.replace(/^!/,'')}).join('')}}})()
DatePicker.prototype.isDateExact=function(one,two){var calendar=this
if((_.isInteger(one)&&_.isInteger(two))||(typeof one=='boolean'&&typeof two=='boolean')){return one===two}if((_.isDate(one)||$.isArray(one))&&(_.isDate(two)||$.isArray(two))){return calendar.create(one).pick===calendar.create(two).pick}if($.isPlainObject(one)&&$.isPlainObject(two)){return calendar.isDateExact(one.from,two.from)&&calendar.isDateExact(one.to,two.to)}return false}
DatePicker.prototype.isDateOverlap=function(one,two){var calendar=this,firstDay=calendar.settings.firstDay?1:0
if(_.isInteger(one)&&(_.isDate(two)||$.isArray(two))){one=one%7+firstDay
return one===calendar.create(two).day+1}if(_.isInteger(two)&&(_.isDate(one)||$.isArray(one))){two=two%7+firstDay
return two===calendar.create(one).day+1}if($.isPlainObject(one)&&$.isPlainObject(two)){return calendar.overlapRanges(one,two)}return false}
DatePicker.prototype.flipEnable=function(val){var itemObject=this.item
itemObject.enable=val||(itemObject.enable==-1?1:-1)}
DatePicker.prototype.deactivate=function(type,datesToDisable){var calendar=this,disabledItems=calendar.item.disable.slice(0)
if(datesToDisable=='flip'){calendar.flipEnable()}else if(datesToDisable===false){calendar.flipEnable(1)
disabledItems=[]}else if(datesToDisable===true){calendar.flipEnable(-1)
disabledItems=[]}else{datesToDisable.map(function(unitToDisable){var matchFound
for(var index=0;index<disabledItems.length;index+=1){if(calendar.isDateExact(unitToDisable,disabledItems[index])){matchFound=true
break}}if(!matchFound){if(_.isInteger(unitToDisable)||_.isDate(unitToDisable)||$.isArray(unitToDisable)||($.isPlainObject(unitToDisable)&&unitToDisable.from&&unitToDisable.to)){disabledItems.push(unitToDisable)}}})}return disabledItems}
DatePicker.prototype.activate=function(type,datesToEnable){var calendar=this,disabledItems=calendar.item.disable,disabledItemsCount=disabledItems.length
if(datesToEnable=='flip'){calendar.flipEnable()}else if(datesToEnable===true){calendar.flipEnable(1)
disabledItems=[]}else if(datesToEnable===false){calendar.flipEnable(-1)
disabledItems=[]}else{datesToEnable.map(function(unitToEnable){var matchFound,disabledUnit,index,isExactRange
for(index=0;index<disabledItemsCount;index+=1){disabledUnit=disabledItems[index]
if(calendar.isDateExact(disabledUnit,unitToEnable)){matchFound=disabledItems[index]=null
isExactRange=true
break}else if(calendar.isDateOverlap(disabledUnit,unitToEnable)){if($.isPlainObject(unitToEnable)){unitToEnable.inverted=true
matchFound=unitToEnable}else if($.isArray(unitToEnable)){matchFound=unitToEnable
if(!matchFound[3])matchFound.push('inverted')}else if(_.isDate(unitToEnable)){matchFound=[unitToEnable.getFullYear(),unitToEnable.getMonth(),unitToEnable.getDate(),'inverted']}break}}if(matchFound)for(index=0;index<disabledItemsCount;index+=1){if(calendar.isDateExact(disabledItems[index],unitToEnable)){disabledItems[index]=null
break}}if(isExactRange)for(index=0;index<disabledItemsCount;index+=1){if(calendar.isDateOverlap(disabledItems[index],unitToEnable)){disabledItems[index]=null
break}}if(matchFound){disabledItems.push(matchFound)}})}return disabledItems.filter(function(val){return val!=null})}
DatePicker.prototype.nodes=function(isOpen){var
calendar=this,settings=calendar.settings,calendarItem=calendar.item,nowObject=calendarItem.now,selectedObject=calendarItem.select,highlightedObject=calendarItem.highlight,viewsetObject=calendarItem.view,disabledCollection=calendarItem.disable,minLimitObject=calendarItem.min,maxLimitObject=calendarItem.max,tableHead=(function(collection,fullCollection){if(settings.firstDay){collection.push(collection.shift())
fullCollection.push(fullCollection.shift())}return _.node('thead',_.node('tr',_.group({min:0,max:DAYS_IN_WEEK-1,i:1,node:'th',item:function(counter){return[collection[counter],settings.klass.weekdays,'scope=col title="'+fullCollection[counter]+'"']}})))})((settings.showWeekdaysFull?settings.weekdaysFull:settings.weekdaysShort).slice(0),settings.weekdaysFull.slice(0)),createMonthNav=function(next){return _.node('div',' ',settings.klass['nav'+(next?'Next':'Prev')]+((next&&viewsetObject.year>=maxLimitObject.year&&viewsetObject.month>=maxLimitObject.month)||(!next&&viewsetObject.year<=minLimitObject.year&&viewsetObject.month<=minLimitObject.month)?' '+settings.klass.navDisabled:''),'data-nav='+(next||-1)+' '+_.ariaAttr({role:'button',controls:calendar.$node[0].id+'_table'})+' '+'title="'+(next?settings.labelMonthNext:settings.labelMonthPrev)+'"')},createMonthLabel=function(){var monthsCollection=settings.showMonthsShort?settings.monthsShort:settings.monthsFull
if(settings.selectMonths){return _.node('select',_.group({min:0,max:11,i:1,node:'option',item:function(loopedMonth){return[monthsCollection[loopedMonth],0,'value='+loopedMonth+(viewsetObject.month==loopedMonth?' selected':'')+(((viewsetObject.year==minLimitObject.year&&loopedMonth<minLimitObject.month)||(viewsetObject.year==maxLimitObject.year&&loopedMonth>maxLimitObject.month))?' disabled':'')]}}),settings.klass.selectMonth,(isOpen?'':'disabled')+' '+_.ariaAttr({controls:calendar.$node[0].id+'_table'})+' '+'title="'+settings.labelMonthSelect+'"')}return _.node('div',monthsCollection[viewsetObject.month],settings.klass.month)},createYearLabel=function(){var focusedYear=viewsetObject.year,numberYears=settings.selectYears===true?5:~~(settings.selectYears/2)
if(numberYears){var
minYear=minLimitObject.year,maxYear=maxLimitObject.year,lowestYear=focusedYear-numberYears,highestYear=focusedYear+numberYears
if(minYear>lowestYear){highestYear+=minYear-lowestYear
lowestYear=minYear}if(maxYear<highestYear){var availableYears=lowestYear-minYear,neededYears=highestYear-maxYear
lowestYear-=availableYears>neededYears?neededYears:availableYears
highestYear=maxYear}return _.node('select',_.group({min:lowestYear,max:highestYear,i:1,node:'option',item:function(loopedYear){return[loopedYear,0,'value='+loopedYear+(focusedYear==loopedYear?' selected':'')]}}),settings.klass.selectYear,(isOpen?'':'disabled')+' '+_.ariaAttr({controls:calendar.$node[0].id+'_table'})+' '+'title="'+settings.labelYearSelect+'"')}return _.node('div',focusedYear,settings.klass.year)}
return _.node('div',(settings.selectYears?createYearLabel()+createMonthLabel():createMonthLabel()+createYearLabel())+createMonthNav()+createMonthNav(1),settings.klass.header)+_.node('table',tableHead+_.node('tbody',_.group({min:0,max:WEEKS_IN_CALENDAR-1,i:1,node:'tr',item:function(rowCounter){var shiftDateBy=settings.firstDay&&calendar.create([viewsetObject.year,viewsetObject.month,1]).day===0?-7:0
return[_.group({min:DAYS_IN_WEEK*rowCounter-viewsetObject.day+shiftDateBy+1,max:function(){return this.min+DAYS_IN_WEEK-1},i:1,node:'td',item:function(targetDate){targetDate=calendar.create([viewsetObject.year,viewsetObject.month,targetDate+(settings.firstDay?1:0)])
var isSelected=selectedObject&&selectedObject.pick==targetDate.pick,isHighlighted=highlightedObject&&highlightedObject.pick==targetDate.pick,isDisabled=disabledCollection&&calendar.disabled(targetDate)||targetDate.pick<minLimitObject.pick||targetDate.pick>maxLimitObject.pick
return[_.node('div',targetDate.date,(function(klasses){klasses.push(viewsetObject.month==targetDate.month?settings.klass.infocus:settings.klass.outfocus)
if(nowObject.pick==targetDate.pick){klasses.push(settings.klass.now)}if(isSelected){klasses.push(settings.klass.selected)}if(isHighlighted){klasses.push(settings.klass.highlighted)}if(isDisabled){klasses.push(settings.klass.disabled)}return klasses.join(' ')})([settings.klass.day]),'data-pick='+targetDate.pick+' '+_.ariaAttr({role:'gridcell',selected:isSelected&&calendar.$node.val()===_.trigger(calendar.formats.toString,calendar,[settings.format,targetDate])?true:null,activedescendant:isHighlighted?true:null,disabled:isDisabled?true:null})),'',_.ariaAttr({role:'presentation'})]}})]}})),settings.klass.table,'id="'+calendar.$node[0].id+'_table'+'" '+_.ariaAttr({role:'grid',controls:calendar.$node[0].id,readonly:true}))+_.node('div',_.node('button',settings.today,settings.klass.buttonToday,'type=button data-pick='+nowObject.pick+(isOpen?'':' disabled')+' '+_.ariaAttr({controls:calendar.$node[0].id}))+_.node('button',settings.clear,settings.klass.buttonClear,'type=button data-clear=1'+(isOpen?'':' disabled')+' '+_.ariaAttr({controls:calendar.$node[0].id})),settings.klass.footer)}
DatePicker.defaults=(function(prefix){return{labelMonthNext:'Next month',labelMonthPrev:'Previous month',labelMonthSelect:'Select a month',labelYearSelect:'Select a year',monthsFull:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdaysFull:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Su','Mo','Tu','We','Th','Fr','Sa'],today:'Today',clear:'Clear',format:'d mmmm, yyyy',klass:{table:prefix+'table',header:prefix+'header',navPrev:prefix+'nav--prev',navNext:prefix+'nav--next',navDisabled:prefix+'nav--disabled',month:prefix+'month',year:prefix+'year',selectMonth:prefix+'select--month',selectYear:prefix+'select--year',weekdays:prefix+'weekday',day:prefix+'day',disabled:prefix+'day--disabled',selected:prefix+'day--selected',highlighted:prefix+'day--highlighted',now:prefix+'day--today',infocus:prefix+'day--infocus',outfocus:prefix+'day--outfocus',footer:prefix+'footer',buttonClear:prefix+'button--clear',buttonToday:prefix+'button--today'}}})(Picker.klasses().picker+'__')
Picker.extend('pickadate',DatePicker)}));window.OT=window.OT||{};OT.createNS=function(namespace){var nsparts=namespace.split("."),parent=OT;if(nsparts[0]==='OT'){nsparts=nsparts.slice(1);}for(var i=0;i<nsparts.length;i++){var partname=nsparts[i];if(typeof parent[partname]==='undefined'){parent[partname]={};}parent=parent[partname];}return parent;};OT.createNS('OT.Common.Cookies');OT.Common.Cookies=(function(_,$document){'use strict';var readCookies=function(){var cookieArr=$document.cookie.split('; '),cookies={};for(var i=0,len=cookieArr.length;i<len;i++){var C=cookieArr[i].split('=');if(C.length<3){cookies[C[0]]=C[1];}else{C[1]=cookieArr[i].substr(C[0].length+1);var nestedC=C[1].split("&");cookies[C[0]]={};for(var j=0;j<nestedC.length;j++){var d=nestedC[j].split("=");cookies[C[0]][d[0]]=d[1];}}}return cookies;};var getCookie=function(key){var result=readCookies()[key];return _.isObject(result)?result:decodeURIComponent(result);};var findCookies=function(term){var obj={};_.each(readCookies(),function(val,key){if(key.indexOf(term)!==-1){obj[key]=getCookie(key);}});return obj;};var isStringNumberBoolean=function(el){return _.isString(el)||_.isNumber(el)||_.isBoolean(el);};var getExpirationValue=function(maxAge){var d=new Date();d.setTime(d.getTime()+maxAge);return d.toGMTString();};var setCookies=function(obj,maxAge,domain){var defaultMaxAge=10*1000,expires=getExpirationValue(maxAge||defaultMaxAge);if(!_.isObject(obj)||_.isArray(obj)){throw new TypeError('setCookie expects an object');}_.forEach(_.keys(obj),function(key){var cookieString=key+"=",cookieValue=obj[key];if(isStringNumberBoolean(cookieValue)){cookieString+=encodeURIComponent(cookieValue.toString());}else if(_.isObject(cookieValue)&&!_.isArray(cookieValue)){_.forEach(cookieValue,function(valVal,valKey){cookieString+=valKey+"=";if(isStringNumberBoolean(valVal)){cookieString+=valVal+"&";}else{throw new TypeError('setCookie expects an object with correct values');}});}else{throw new TypeError('setCookie expects an object with correct values');}if(cookieString.slice(-1)==="&"){cookieString=cookieString.substr(0,cookieString.length-1);}cookieString+=";path=/;expires="+expires;if(!!domain){cookieString+=";domain=."+domain;}$document.cookie=cookieString;});};return{getAll:readCookies,get:getCookie,find:findCookies,set:setCookies};})(ot_,document);OT.createNS('OT.Common.Select');OT.Common.Select=(function($,_){'use strict';var _data={};var templates={nativeDesign:function(m){var t='<div class="'+m.cssClass+' ot-dtp-picker-selector'+(m.unselectedOnInit?" unselected-on-init":'')+'">'+'  <a class="ot-select-label ot-dtp-picker-selector-link" tabindex="-1">'+m.selectedValue+'</a>'+'  <select name="'+m.name+'">';for(var i=0;i<m.options.length;i++){var option=m.options[i],isChecked=option.selected?" selected=\"selected\"":'';t+='    <option value="'+option.value+'"'+isChecked+'>'+option.display+'</option>';}t+='  </select>'+'</div>';return t;}};var getUniqueName=function(isNative){var c=0,name="Select_"+c,htmlAttribute=isNative?'select':'input';while($(htmlAttribute+"[name='"+name+"']").length>0){c++;name="Select_"+c;}return name;};var getSelectModel=function($select){var outerHtml=function($el){return $("<div />").append($el.clone()).html();},unselectedOnInit=false;var name=getUniqueName(true),model={name:name,cssClass:$select.attr("class")||"",unselectedOnInit:false,options:_.map($select.find("option"),function(option){var $option=$(option),selected=$option.prop('selected');if(!!selected&&outerHtml($option).indexOf("selected")===-1){unselectedOnInit=true;}return{display:$option.text(),value:$option.val(),selected:selected};})};_data[name]=model.options;var selected=_.findWhere(model.options,{selected:true});model.selectedValue=!!selected?selected.display:'';if(model.selectedValue===''||unselectedOnInit){model.unselectedOnInit=true;}return model;};var transformSelect=function($select){$select.addClass("ot-hide");var $parent=$select.parent(),model=getSelectModel($select);$select.after(templates['nativeDesign'](model));$select.remove();var $newSelect=$parent.find("."+model.cssClass.replace(/ /g,'.')),$label=$newSelect.find(".ot-select-label");$label.text(model.selectedValue);$newSelect.removeClass("ot-hide");return $newSelect;};var select={info:function($select){return{unselectedOnInit:$select.hasClass("unselected-on-init")};},init:function($select){return select.initNative($select);},initNative:function($select){var $newSelect=transformSelect($select,true),$label=$newSelect.find(".ot-select-label"),previousValue=$newSelect.find("select").val();$newSelect.find("select").on('change keyup',function(){var $this=$(this),selectedValue=$this.val(),$selectedOption=$this.find("option[value='"+selectedValue+"']"),selectedDisplayValue=$selectedOption.text();if(previousValue!==selectedValue){previousValue=selectedValue;$label.text(selectedDisplayValue);OT.Events.fire("select:change",{sender:$this.parent()});}});return $newSelect;},get:function($select){return $select.find("select").val();},hide:function($select,values){if(!_.isArray(values)){values=[values];}_.forEach(values,function(value){var optionToHide=$select.find("option[value='"+value+"']");if(optionToHide.length>0){optionToHide.remove();}});},select:function($select,value){var $selectedOption=$select.find("option[value='"+value+"']"),$label=$select.find(".ot-select-label");$select.find("option").removeAttr("selected");$select.find("select").val(value);$label.text($selectedOption.text());OT.Events.fire("select:change",{sender:$select});},showAll:function($select){var selectName=$select.find("select").attr("name"),initialOptions=_data[selectName]||[],newOptions="";for(var i=0;i<initialOptions.length;i++){var option=initialOptions[i];if($select.find("option[value='"+option.value+"']").length===0){newOptions+="<option value='"+option.value+"'>"+option.display+"</option>";}}if(newOptions.length>0){$select.find("select").prepend(newOptions);}},update:function(e,$selectedLabel){var $target=$(e.currentTarget),$options=$target.parent().parent(),$option=$options.find('label[data-value="'+$target.attr('name')+'_'+$target.val()+'"]');$options.find('.highlight').removeClass('highlight');$option.addClass("highlight");$options.find("input").attr("checked",false);$target.attr("checked",true);$selectedLabel.text($option.text());closeActiveMenus();OT.Events.fire("select:change",{sender:$($selectedLabel.parent())});}};$.fn.OTselect=function(action,param){var $this=this;if(action==="init"){return select.init($this,param);}else if(action==="get"){return select.get($this);}else if(action==="select"){return select.select($this,param);}else if(action==="info"){return select.info($this);}else if(action==="showAll"){return select.showAll($this);}else if(action==="hide"){return select.hide($this,param);}return this;};return{init:select.init,get:select.get,select:select.select};})(jQuery,ot_);OT.createNS('OT.Common.DatePicker');OT.Common.DatePicker=(function($,moment){'use strict';var getLabelValue=function($dp){var selectedDay=$dp.get('highlight','yyyy-mm-dd'),today=moment().format('YYYY-MM-DD'),isToday=(today===selectedDay),textLabel=$dp.get();return isToday&&OT.Widget.options&&!!OT.Widget.options.waitlistEnabled?OT.Widget.todayLabel:textLabel;};var datepicker={get:function($datepicker,optionalFormat){var $datepickerInput=$datepicker.find('input'),$picker=$datepickerInput.pickadate('picker');if(!!optionalFormat){return $picker.get('select',optionalFormat);}return $picker.get('select');},getOriginalValue:function($datepicker){return $datepicker.find('input').attr('data-value');},init:function($datepicker,minDate){var cssClass=$datepicker.attr('class'),dateValue=$datepicker.val(),$parent=$datepicker.parent(),isJapanese=false,calendarStartsSunday=(typeof(OT)!=='undefined'&&!!OT.Widget)?!!OT.Widget.calendarStartsSunday:true;var template=function(dateValue){return'<div class="'+cssClass+'">'+'  <a class="ot-dtp-picker-selector-link ot-date-label ot-dtp-picker-label">'+dateValue+'</a>'+'  <input type="text" name="datepicker" onfocus="this.blur()" class="ot-datepicker ot-dtp-picker-select" style="cursor: pointer;" data-value="'+dateValue+'" />'+'</div>';};if(dateValue===''){dateValue=moment().format('YYYY-MM-DD');}$datepicker.after(template(dateValue));$datepicker.remove();$datepicker=$parent.find('.'+cssClass.replace(/ /g,'.'));var $label=$datepicker.find('.ot-date-label'),$datePickerInput=$datepicker.find('input');if(OT.Widget.lang){setupLanguage(OT.Widget.lang);if(OT.Widget.lang==='ja'){isJapanese=true;}}var fixJapaneseYearMonthLabel=function(){var $headerYear=$datepicker.find('.picker__year'),$headerMonth=$datepicker.find('.picker__month'),$parent=$headerMonth.parent(),outerHtml=function($el){return $('<div />').append($el.clone()).html();},newHeaderContent=outerHtml($headerYear)+outerHtml($headerMonth);$headerYear.remove();$headerMonth.remove();$parent.prepend(newHeaderContent);$headerYear=$datepicker.find('.picker__year');var headerYearText=$headerYear.text();if(headerYearText.indexOf('年')<0){$headerYear.text(headerYearText+'年');}};var closeDpIfOpened=function($dp){if(!!$dp.get('open')){$dp.close();}};var getRenderPosition=function(){var calendarHeight=290,labelHeight=$datePickerInput.height(),datePickerOffset=parseInt($datepicker.offset().top,10),bodyScroll=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop,$body=$('body'),bodyHeight=$body.height(),marginBottom=bodyScroll+bodyHeight-labelHeight-datePickerOffset,marginTop=datePickerOffset-bodyScroll;return marginTop<calendarHeight?'down':(marginBottom>=calendarHeight?'down':'up');};var addCloseButton=function(thisDatepicker){var $pickerBox=$datepicker.find('.picker__box');var $pickerClose=$('<div class="picker__close" data-clear="true">'+getCloseButtonText()+'</div>');$pickerClose.on('click touchend',function(){closeDpIfOpened(thisDatepicker);});$pickerBox.before($pickerClose);};$datePickerInput.pickadate({firstDay:calendarStartsSunday?0:1,min:minDate?moment(minDate).toDate():new Date(),formatSubmit:'yyyy-mm-dd',hiddenPrefix:'submit_',hiddenSuffix:'',today:'',clear:'',format:OT.Common.Helpers.getDateFormatJS(),onStart:function(){var thisDatepicker=this;$label.text(getLabelValue(thisDatepicker));OT.Events.on('menus:cleared',function(){if($label.hasClass('picker-opening')){$label.removeClass('picker-opening');}else{closeDpIfOpened(thisDatepicker);}});addCloseButton(thisDatepicker);},onOpen:function(){if(isJapanese){fixJapaneseYearMonthLabel();}$label.addClass('picker-opening');$label.addClass('menu-opened');var $cal=$datepicker.find('.picker'),renderPosition=getRenderPosition();$cal.removeClass('up').removeClass('down').addClass(renderPosition);},onClose:function(){$label.removeClass('menu-opened');},onSet:function(){$label.text(getLabelValue(this));OT.Events.fire('datepicker:change',{sender:$datepicker});if(isJapanese){fixJapaneseYearMonthLabel();}}});return $datepicker;},refresh:function($datepicker){var $datepickerInput=$datepicker.find('input');if($datepickerInput.length===0){return;}var $dp=$datepickerInput.pickadate('picker');if($dp.length===0){return;}var $label=$datepicker.find('.ot-date-label');if($label.length===0){return;}$label.text(getLabelValue($dp));},set:function($datepicker,value,format){var $datepickerInput=$datepicker.find('input'),optionalFormat=format||{format:'yyyy-mm-dd'};return $datepickerInput.pickadate('picker').set('select',value,optionalFormat);}};var getCloseButtonText=function(){return $.fn.pickadate.defaults.close||'Close';};var setupLanguage=function(lang){$.extend($.fn.pickadate.defaults,OT.Common.Helpers.DatePickerLocales.get(lang));};$.fn.OTdatepicker=function(action,param,param2){var $this=this;if(action==='init'){return datepicker.init($this,param);}else if(action==='get'){return datepicker.get($this,param);}else if(action==='getOriginalValue'){return datepicker.getOriginalValue($this,param);}else if(action==='refresh'){return datepicker.refresh($this);}else if(action==='set'){return datepicker.set($this,param,param2);}return this;};return{init:datepicker.init,get:datepicker.get,getOriginalValue:datepicker.getOriginalValue,set:datepicker.set};})(jQuery,ot_moment);OT.createNS('OT.Common.Helpers.DatePickerLocales');OT.Common.Helpers.DatePickerLocales=(function(){'use strict';var localeData={ja:{monthsFull:['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],monthsShort:['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],weekdaysFull:['日','月','火','水','木','金','土'],weekdaysShort:['日','月','火','水','木','金','土'],today:'今日',clear:'消去',labelMonthNext:'次月',labelMonthPrev:'前月',close:'閉じる'},es:{monthsFull:['enero','febrero','marzo','abril','mayo','junio','julio','agosto','septiembre','octubre','noviembre','diciembre'],monthsShort:['ene','feb','mar','abr','may','jun','jul','ago','sep','oct','nov','dic'],weekdaysFull:['domingo','lunes','martes','miércoles','jueves','viernes','sábado'],weekdaysShort:['do','lu','ma','mi','ju','vi','sá'],today:'hoy',clear:'borrar',labelMonthNext:'Mes próximo',labelMonthPrev:'Mes anterior',close:'Cerrar'},fr:{monthsFull:['Janvier','Février','Mars','Avril','Mai','Juin','Juillet','Août','Septembre','Octobre','Novembre','Décembre'],monthsShort:['Jan','Fev','Mar','Avr','Mai','Juin','Juil','Aou','Sep','Oct','Nov','Dec'],weekdaysFull:['Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'],weekdaysShort:['Di','Lu','Ma','Me','Je','Ve','Sa'],today:'Aujourd\'hui',clear:'Effacer',labelMonthNext:'Mois suivant',labelMonthPrev:'Mois précédent',close:'Fermer'},de:{monthsFull:['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'],monthsShort:['Jan','Feb','Mär','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'],weekdaysFull:['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'],weekdaysShort:['So','Mo','Di','Mi','Do','Fr','Sa'],today:'Heute',clear:'Löschen',labelMonthNext:'Nächste',labelMonthPrev:'Früher',close:'Schließen'},nl:{monthsFull:['Januari','Februari','Maart','April','Mei','Juni','Juli','Augustus','September','Oktober','November','December'],monthsShort:['Jan','Feb','Mrt','Apr','Mei','Jun','Jul','Aug','Sep','Okt','Nov','Dec'],weekdaysFull:['Zondag','Maandag','Dinsdag','Woensdag','Donderdag','Vrijdag','Zaterdag'],weekdaysShort:['Zo','Ma','Di','Wo','Do','Vr','Za'],today:'Vandaag',clear:'Verwijderen',labelMonthNext:'Volgende',labelMonthPrev:'Vorige',close:'Sluiten'},it:{monthsFull:['gennaio','febbraio','marzo','aprile','maggio','giugno','luglio','agosto','settembre','ottobre','novembre','dicembre'],monthsShort:['gen','feb','mar','apr','mag','giu','lug','ago','set','ott','nov','dic'],weekdaysFull:['domenica','lunedì','martedì','mercoledì','giovedì','venerdì','sabato'],weekdaysShort:['dom','lun','mar','mer','gio','ven','sab'],today:'Oggi',clear:'Cancella',labelMonthNext:'Mese successivo',labelMonthPrev:'Mese precedente',close:'Chiudi'},pl:{monthsFull:['styczeń','luty','marzec','kwiecień','maj','czerwiec','lipiec','sierpień','wrzesień','październik','listopad','grudzień'],monthsShort:['sty','lut','mar','kwi','maj','cze','lip','sie','wrz','paź','lis','gru'],weekdaysFull:['niedziela','poniedziałek','wtorek','środa','czwartek','piątek','sobota'],weekdaysShort:['niedz.','pn.','wt.','śr.','cz.','pt.','sob.'],today:'Dzisiaj',clear:'Usuń',labelMonthNext:'następny',labelMonthPrev:'poprzedni',close:'Zamknij'},zh:{monthsFull:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],monthsShort:['一','二','三','四','五','六','七','八','九','十','十一','十二'],weekdaysFull:['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],weekdaysShort:['日','一','二','三','四','五','六'],today:'今日',clear:'清除',labelMonthNext:'下个月',labelMonthPrev:'上个月',close:'关闭'}};var get=function(lang){return localeData[lang];};return{get:get};})();OT.createNS('OT.Common.Helpers.QueryString');OT.Common.Helpers.QueryString=(function(_){'use strict';var safeConsole={log:function(msg){return typeof(console)!=='undefined'&&!!console.log&&console.log(msg);}};var ensure={isValid:{key:function(key){if(!key){throw new Error('QueryString: No parameter passed');}},object:function(obj){if(!obj){throw new TypeError('stringify expects an object');}}}};var parse=function(query,splitCommaSeparatedValues){if(_.isBoolean(query)){splitCommaSeparatedValues=query;query=undefined;}var params=!!query?query.replace('?',''):window.location.search.substring(1),paramsObj={};params=params!==''?params.split('&'):'';for(var i=0;i<params.length;i++){var keyVal=params[i].split('='),key=keyVal[0],val=decodeURIComponent(keyVal[1]);paramsObj[key]=val;if(val.trim().toLowerCase()==='true'){paramsObj[key]=true;}if(val.trim().toLowerCase()==='false'){paramsObj[key]=false;}}return!!splitCommaSeparatedValues?splitCommaSeparatedStrings(paramsObj):paramsObj;};var find=function(key,query,splitCommaSeparatedValues){ensure.isValid.key(key);if(_.isBoolean(query)){splitCommaSeparatedValues=query;query=undefined;}var parsed=parse(query);if(!!splitCommaSeparatedValues){parsed=splitCommaSeparatedStrings(parsed);}if(_.has(parsed,key)){return parsed[key];}for(var objKey in parsed){if(objKey.trim().toLowerCase()===key.trim().toLowerCase()){return parsed[objKey];}}return undefined;};var splitCommaSeparatedStrings=function(obj){var splitted={};_.forEach(obj,function(v,k){splitted[k]=_.isString(v)&&v.indexOf(',')>=0?v.split(','):v;});return splitted;};var parseParams=function(query){safeConsole.log('OT.Common.Helpers.QueryString.getAll is deprecated, use parse() instead');var parsed=parse(query),lowered={};_.forEach(parsed,function(v,k){lowered[k.toLowerCase()]=_.isString(v)?v.toLowerCase():v;});return splitCommaSeparatedStrings(lowered);};var getParam=function(key,query){safeConsole.log('OT.Common.Helpers.QueryString.get is deprecated, use find() instead');ensure.isValid.key(key);return parseParams(query)[key.toLowerCase()];};var stringifyString=function(str,prefix){ensure.isValid.object(prefix);return prefix+'='+encodeURIComponent(str);};var stringifyArray=function(arr,prefix){ensure.isValid.object(prefix);var ret=[];for(var i=0;i<arr.length;i++){ret.push(stringify(arr[i],prefix+'['+i+']'));}return ret.join('&');};var stringifyObject=function(obj,prefix){var ret=[],keys=_.keys(obj),key;for(var i=0,len=keys.length;i<len;++i){key=keys[i];if(''===key){continue;}var encodedKey=encodeURIComponent(key);if(null==obj[key]){ret.push(encodedKey+'=');}else{ret.push(stringify(obj[key],prefix?prefix+'['+encodedKey+']':encodedKey));}}return ret.join('&');};var stringify=function(obj,prefix){if(_.isArray(obj)){return stringifyArray(obj,prefix);}else if(_.isObject(obj)){return stringifyObject(obj,prefix);}else if(_.isString(obj)){return stringifyString(obj,prefix);}else{return prefix+'='+encodeURIComponent(String(obj));}};return{get:getParam,getAll:parseParams,find:find,parse:parse,stringify:stringify};})(ot_);OT.createNS('OT.Common.Helpers.getDateFormatJS');OT.Common.Helpers.getDateFormatJS=function(){'use strict';return OT.Widget.dateFormatJS||"d mmmm, yyyy";};OT.createNS('OT.Common.Helpers.getTimeFormatJS');OT.Common.Helpers.getTimeFormatJS=function(){'use strict';return OT.Widget.timeFormatJS||"HH:mm";};OT.createNS('OT.Common.Helpers.convertTimeTo24Hour');OT.Common.Helpers.convertTimeTo24Hour=function(time){var timeOfDay=time.match(/AM|PM|a.m.|p.m./i);if(timeOfDay!==null){timeOfDay=timeOfDay[0];time=time.replace(/ AM| PM| a.m.| p.m./i,'').split(':');if((timeOfDay==='AM'||timeOfDay==='a.m.')&&time[0]==='12'){time[0]='00';}if((timeOfDay==='PM'||timeOfDay==='p.m.')&&parseInt(time[0],10)<12){time[0]=parseInt(time[0],10)+12;}time=time.join(':');}return time;};OT.createNS('OT.Common.Helpers');OT.Common.Helpers.convertIsoDateTimeToTimestamp=(function(moment){'use strict';var convert=function(date,time){var time24Hours=OT.Common.Helpers.convertTimeTo24Hour(time),datetime=date+' '+time24Hours;return moment(datetime,'YYYY-MM-DD HH:mm').format('X');};return convert;})(ot_moment);OT.createNS('OT.Common.Helpers.isFutureDateTime');OT.Common.Helpers.isFutureDateTime=(function(moment){var isFutureDateTime=function(time,presentTime){var now=moment().format('X');return time*1>(presentTime||now)*1;};return isFutureDateTime;})(ot_moment);OT.createNS('OT.Common.Helpers.RoundTimeTo');OT.Common.Helpers.RoundTimeTo=(function(moment){var quarterHour=function(time){time=OT.Common.Helpers.convertTimeTo24Hour(time);var mins=time.split(':');if(+mins[1]>45){mins[0]++;mins[1]='00';}else if(+mins[1]>30){mins[1]='45';}else if(+mins[1]>15){mins[1]='30';}else{mins[1]='15';}return moment(mins[0]+':'+mins[1],'H:mm').format(OT.Common.Helpers.getTimeFormatJS());};var halfHour=function(time,format){time=OT.Common.Helpers.convertTimeTo24Hour(time);var mins=time.split(':');if(mins[1]>30){mins[0]++;mins[1]='00';}else{mins[1]='30';}return moment(mins[0]+':'+mins[1],'H:mm').format(format||OT.Common.Helpers.getTimeFormatJS());};return{quarterHour:quarterHour,halfHour:halfHour};})(ot_moment);OT.createNS('OT.Common.Helpers.getMinimumDate');OT.Common.Helpers.getMinimumDate=(function(moment){'use strict';var get=function(metroDateTime){var metroDate=metroDateTime.format("YYYY-MM-DD"),minDate=metroDate;if(moment(metroDateTime.format('YYYY-MM-DD HH:mm')).format('X')>=moment(moment(metroDate+"T23:30").format('YYYY-MM-DD HH:mm')).format('X')){minDate=metroDateTime.add(1,'days').format("YYYY-MM-DD");}return minDate;};return get;})(ot_moment);OT.createNS('OT.Common.Helpers.dateTimeValidator');OT.Common.Helpers.dateTimeValidator=(function(moment){'use strict';var helpers=OT.Common.Helpers;var isDateTimeValid=function(date,time,metroDate,metroTime){if(!!date&&!!time){var timestamp=helpers.convertIsoDateTimeToTimestamp(date,time),metroTimeStamp=helpers.convertIsoDateTimeToTimestamp(metroDate,metroTime);return helpers.isFutureDateTime(timestamp,metroTimeStamp);}return false;};var Validator=function(metroDate,metroTime){return function(date,time){return isDateTimeValid(date,time,metroDate,metroTime);};};var isMayor=function(time1,time2){return time1.replace(":","")>time2.replace(":","");};var get=function(date,time,metroDate,metroTime){var isValid=new Validator(metroDate,metroTime),defaultTime='19:00',tomorrowDate=moment(metroDate).add(1,'days').format('YYYY-MM-DD');time=time||defaultTime;date=date||metroDate;if(isValid(date,time)){return{date:date,time:time};}if(isMayor(metroTime,defaultTime)){var nextRoundedTimeSlot=helpers.RoundTimeTo.halfHour(metroTime,"HH:mm");if(time===metroTime&&nextRoundedTimeSlot===metroTime){nextRoundedTimeSlot=helpers.RoundTimeTo.halfHour(metroTime.substr(0,4)+"1","HH:mm");}if(isValid(date,nextRoundedTimeSlot)){return{date:date,time:nextRoundedTimeSlot};}if(isValid(metroDate,nextRoundedTimeSlot)){return{date:metroDate,time:nextRoundedTimeSlot};}}if(isValid(date,defaultTime)){return{date:date,time:defaultTime};}if(isValid(metroDate,defaultTime)){return{date:metroDate,time:defaultTime};}if(isValid(tomorrowDate,defaultTime)){return{date:tomorrowDate,time:defaultTime};}return{date:metroDate,time:helpers.RoundTimeTo.halfHour(moment('2000-01-01T'+metroTime).format("HH:mm"),"HH:mm")};};return{get:get};})(ot_moment);OT.createNS('OT.Common.Helpers.timeSlotsAvailability');OT.Common.Helpers.timeSlotsAvailability=(function(_){var timeSlots=function(){'use strict';var helpers=OT.Common.Helpers;var allTimeSlots=['00:00','00:30','01:00','01:30','02:00','02:30','03:00','03:30','04:00','04:30','05:00','05:30','06:00','06:30','07:00','07:30','08:00','08:30','09:00','09:30','10:00','10:30','11:00','11:30','12:00','12:30','13:00','13:30','14:00','14:30','15:00','15:30','16:00','16:30','17:00','17:30','18:00','18:30','19:00','19:30','20:00','20:30','21:00','21:30','22:00','22:30','23:00','23:30'];var isDatePast=function(date,metroDate,metroTime){if(!!date){var timestamp=helpers.convertIsoDateTimeToTimestamp(date,'23:59'),metroTimeStamp=helpers.convertIsoDateTimeToTimestamp(metroDate,metroTime);return!helpers.isFutureDateTime(timestamp,metroTimeStamp);}return true;};var isDateMayor=function(date1,date2){return date1.replace(/-/g,"")>date2.replace(/-/g,"");};var isTimeMayor=function(time1,time2){return time1.replace(":","")>time2.replace(":","");};return{get:function(date,metroDate,metroTime){date=date||metroDate;if(isDatePast(date,metroDate,metroTime)){return[];}return _.filter(_.clone(allTimeSlots),function(timeSlot){return isDateMayor(date,metroDate)||isTimeMayor(timeSlot,metroTime);});}};};return timeSlots;})(ot_);OT.createNS('OT.Events');OT.Events=(function($){'use strict';var eventObject=$({});var getAllEvents=function(){return $.map(eventObject.get(0),function(i,e){return eventObject.get(0)[e].events;})[0]||[];};var getEvent=function(key){if(!key){return getAllEvents();}return getAllEvents()[key];};var hasEvent=function(key){return!!getAllEvents()[key];};var setEvent=function(key,cb){eventObject.on(key,cb||function(){});};var fireEvent=function(key,data){eventObject.trigger(key,data||[]);};var removeEvent=function(key){eventObject.off(key);};var reset=function(){eventObject.off();};return{get:getEvent,has:hasEvent,on:setEvent,fire:fireEvent,remove:removeEvent,reset:reset};})(jQuery);OT.createNS('OT.Common.TestObject');OT.Common.TestObject=(function($,_){'use strict';var $body=$('body'),testArray=[];var refresh=function(){var tests=OT.Common.Helpers.QueryString.find('tests',true);if(!tests){testArray=[];}else{if(_.isString(tests)){tests=[tests];}testArray=_.map(tests,function(val){return val.toLowerCase();});}};var buildTestArray=function(fresh){if(fresh){refresh();}$body.addClass(testArray.join(' '));return testArray;};var isActive=function(tests){if(!tests){return false;}var allTestsAreOn=true;if(typeof tests==='string'){tests=[tests];}_.each(tests,function(test){if(testArray.indexOf(test.toLowerCase())===-1){allTestsAreOn=false;}});return allTestsAreOn;};var set=function(key,val){if(_.isNull(key)||_.isNull(val)){throw new Error('testArray: No parameters provided');}testArray.push(key.toLowerCase());};refresh();buildTestArray();return{set:set,getAll:buildTestArray,refresh:refresh,isActive:isActive};})(jQuery,ot_);OT.createNS('OT.Common.Analytics');OT.Common.Analytics=(function($,_,$window,$document){var check={callbackIsDefined:function(callback){return _.isFunction(callback);},s_isDefined:function($scope){return!_.isUndefined($scope.s);},s_t_isDefined:function($scope){return this.s_isDefined($scope)&&_.isFunction($scope.s.t);},s_tl_isDefined:function($scope){return this.s_isDefined($scope)&&_.isFunction($scope.s.tl);},s_gi_isDefined:function($scope){return _.isFunction($scope.s_gi);},s_codeIsLoaded:function($scope){return this.s_t_isDefined($scope)&&this.s_tl_isDefined($scope);}};var set={configuration:function($w,$d){var hostnamePointsMatches=$d.location.hostname.match(/\./g),hostnamePoints=hostnamePointsMatches?hostnamePointsMatches.length:3;return _.extend($w,{s_account:OT.Widget.omniture.account||"ottoptableqa",ottrackserver:OT.Widget.omniture.server||"o.opentable.com",ottracksecureserver:OT.Widget.omniture.sserver||"so.opentable.com",otcookiedomainperiods:hostnamePoints});},globals:function($scope){$scope.s_getLoadTime=function(){if(!$scope.s_loadT){var b=new Date().getTime(),o=$scope.performance?$scope.performance.timing:0,a=o?o.requestStart:$scope.inHeadTS||0;$scope.s_loadT=a?Math.round((b-a)/100)/10:"";}return $scope.s_loadT;};$scope.s_getLoadTime();},optimizelyIntegration:function($scope){$scope.optimizely=$scope.optimizely||[];$scope.optimizely.push("activateSiteCatalyst");},parameters:function($scope,parameters){return _.extend($scope,parameters);},script:function($scope,href,callback){var head=$scope.getElementsByTagName("head")[0],newScript=_.extend($scope.createElement("script"),{type:"text/javascript",src:href,onload:callback});head.appendChild(newScript);}};var send={trackingClickData:function($scope,omnitureIstance,linkObject,linkType,linkReference,callback){return check.s_tl_isDefined($scope)?$scope.s.tl(linkObject,linkType,linkReference,{},callback):callback(false);},trackingData:function($scope,callback){if(check.s_t_isDefined($scope)){$scope.s.t();setTimeout(callback,$scope.s.forcedLinkTrackingTimeout);}else{callback(false);}}};var track={clickData:function($scope,linkObject,linkType,linkReference,parameters,callback){if(!check.s_gi_isDefined($scope)){return check.callbackIsDefined(callback)?callback():false;}var omnitureIstance=$scope.s_gi($scope.s_account);if(!!parameters){set.parameters(omnitureIstance,parameters);}send.trackingClickData($scope,omnitureIstance,linkObject,linkType,linkReference,function(){if(check.callbackIsDefined(callback)){callback();}});},initialData:function($scope,parameters,callback){if(!check.s_isDefined($scope)){return check.callbackIsDefined(callback)?callback(false):false;}set.optimizelyIntegration($scope);set.parameters($scope.s,parameters);send.trackingData($scope,function(){if(check.callbackIsDefined(callback)){callback();}});}};set.globals($window);var initSent=false,retries=2,retryTimeout=1000;return{_test:function(w,d,timeout){$window=w;$document=d;retryTimeout=timeout;set.globals($window);initSent=false;},init:function(parameters,callback){$(function(){var done=function(){OT.Events.fire('analytics:initialised');initSent=true;if(_.isFunction(callback)){callback();}};set.configuration($window,$document);var pathToS_code=OT.Widget.location+"assets/js/s_code.js";if(!check.s_codeIsLoaded($window)){set.script($document,pathToS_code,function(){track.initialData($window,parameters,done);});}else{track.initialData($window,parameters,done);}});},send:function(linkObject,linkType,linkReference,parameters,callback){$(function(){var performSendEvent=function(){track.clickData($window,linkObject,linkType,linkReference,parameters,callback);};var initDone=function(cb){if(initSent){return cb();}if(retries>=0){retries--;setTimeout(function(){initDone(cb);},retryTimeout);}else{return cb();}};initDone(performSendEvent);});}};})(jQuery,ot_,window,document);(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-52354388-1','auto');ga('send','pageview',window.otGoogleAnalyticsDimensions||{});OT.createNS('OT.Common.Dtp');OT.Common.Dtp=(function($,_,moment){'use strict';var selectors={partySizePicker:'.ot-party-size-picker',timePicker:'.ot-time-picker',datePicker:'.ot-date-picker',dtpForm:'.ot-dtp-picker-form',timezoneOffset:'input[name="timezoneOffset"]'};var DTP_COOKIE_IDENTIFIER="ot_widget_dtp_values",DTP_COOKIE_MAXAGE=365*24*60*60*1000;var tabIndexCounter=0,_validateDateTime=true,_shouldEmitChangedEvent=true;var cookies={get:function(key){var cookied=OT.Common.Cookies.get(DTP_COOKIE_IDENTIFIER);return typeof(key)==='string'?((!!cookied&&!!cookied[key])?cookied[key]:undefined):cookied;},set:function(values){var cookiedValues={};cookiedValues[DTP_COOKIE_IDENTIFIER]=_.pick(values,'covers','datetime');return OT.Common.Cookies.set(cookiedValues,DTP_COOKIE_MAXAGE);}};var getMetroOffset=function($dtp){var metroOffset=0,$dtpOffset=$dtp?$dtp.find(selectors.timezoneOffset):[];if($dtpOffset.length>0){metroOffset=$dtpOffset.val();}else if(!!pageData&&pageData.headerTimezoneOffset){metroOffset=pageData.headerTimezoneOffset;}return metroOffset;};var getMetroDateTime=function($dtp){return moment().utc().add(getMetroOffset($dtp),'m');};var setTabIndexes=function(inputs,startIndex){inputs.datePicker.attr("tabindex",startIndex+1);inputs.timePicker.attr("tabindex",startIndex+2);inputs.partySizePicker.attr("tabindex",startIndex+3);inputs.searchButton.attr("tabindex",startIndex+4);return startIndex+4;};var setHighlighting=function(formInputs,labelInputs){var highlightOnFocus=function($formInput,$labelInput){$formInput.focus(function(){$labelInput.addClass('highlighted');});};var unhighlightOnBlur=function($formInput,$labelInput){$formInput.blur(function(){$labelInput.removeClass('highlighted');});};_.forEach(labelInputs,function($labelInput,key){highlightOnFocus(formInputs[key],$labelInput);unhighlightOnBlur(formInputs[key],$labelInput);});};var dtp={init:function(dtpSelector){$(dtpSelector).each(function(){var $dtp=$(this);$dtp.addClass("ot-hide");var metroDateTime=getMetroDateTime($dtp),minDate=OT.Common.Helpers.getMinimumDate(metroDateTime),$timePicker=$dtp.find(selectors.timePicker).OTselect("init"),$partySizePicker=$dtp.find(selectors.partySizePicker).OTselect("init"),$datepicker=$dtp.find(selectors.datePicker).OTdatepicker("init",minDate),$form=$dtp.find(selectors.dtpForm),dateTimeValidator=OT.Common.Helpers.dateTimeValidator;var selectInitValueFor={covers:function(){var isValid=function(val){return!!val&&val<=21&&val>0;};var valueWasSupplied=!$partySizePicker.OTselect("info").unselectedOnInit,suppliedValue=valueWasSupplied?$partySizePicker.OTselect("get"):null,defaultValue=2;if(!isValid(suppliedValue)){var cookiedValue=cookies.get('covers'),coversValue=isValid(cookiedValue)?cookiedValue:defaultValue;$partySizePicker.OTselect("select",coversValue);}},dateTime:function(){var metroDateTime=getMetroDateTime($dtp),metroDate=metroDateTime.format("YYYY-MM-DD"),metroTime=metroDateTime.format("HH:mm");var isValid=function(date,time){if(!date||!time){return false;}var validated=dateTimeValidator.get(date,time,metroDate,metroTime);return validated.date===date&&validated.time===time;};var suppliedValue={time:$timePicker.OTselect("info").unselectedOnInit?null:$timePicker.OTselect("get"),date:$datepicker.OTdatepicker("getOriginalValue")};var setValues=(function(originalDate,originalTime){return function(newValues){if(originalDate!==newValues.date){$datepicker.OTdatepicker("set",newValues.date);}if(originalTime!==newValues.time){$timePicker.OTselect("select",newValues.time);}};})(suppliedValue.date,suppliedValue.time);if(!isValid(suppliedValue.date,suppliedValue.time)){var cookiedDateTimeValue=cookies.get('datetime'),splitted=!!cookiedDateTimeValue?cookiedDateTimeValue.split(" "):[],cookiedValue=splitted.length===0?undefined:{date:splitted[0],time:splitted[1]};if(!cookiedValue){setValues(dateTimeValidator.get(suppliedValue.date,suppliedValue.time,metroDate,metroTime));}else if(isValid(cookiedValue.date,cookiedValue.time)){setValues(cookiedValue);}else{setValues(dateTimeValidator.get(cookiedValue.date,cookiedValue.time,metroDate,metroTime));}}}};var hidePastTimes=function(){$timePicker.OTselect("showAll");var metroDateTime=getMetroDateTime($dtp),metroDate=metroDateTime.format("YYYY-MM-DD"),metroTime=metroDateTime.format("HH:mm"),currentDate=$datepicker.OTdatepicker("get",'yyyy-mm-dd'),availability=OT.Common.Helpers.timeSlotsAvailability(),availableTimeSlots=availability.get(currentDate,metroDate,metroTime),timeOptions=$timePicker.find("option");for(var i=0;i<timeOptions.length;i++){var $option=$(timeOptions[i]),value=$option.attr("value");if(!_.contains(availableTimeSlots,value)){$timePicker.OTselect("hide",value);}}};var fixDateTimeValues=function(callback){if(!_validateDateTime){return callback();}var metroDateTime=getMetroDateTime($dtp),metroDate=metroDateTime.format("YYYY-MM-DD"),metroTime=metroDateTime.format("HH:mm"),currentTime=$timePicker.OTselect("get"),currentDate=$datepicker.OTdatepicker("get",'yyyy-mm-dd'),validDateTime=dateTimeValidator.get(currentDate,currentTime,metroDate,metroTime);if(currentDate!==validDateTime.date){$datepicker.OTdatepicker("set",validDateTime.date);}else if(currentTime!==validDateTime.time){$timePicker.OTselect("select",validDateTime.time);}else if(typeof(callback)==='function'){callback();}};var formInputs={partySizePicker:$partySizePicker.find("select"),datePicker:$datepicker.find("input"),timePicker:$timePicker.find("select"),searchButton:$form.find("input.ot-button")};var labelInputs={partySizePicker:$partySizePicker.find("a"),datePicker:$datepicker.find("a"),timePicker:$timePicker.find("a")};var updateTimeOptionsForWaitList=function(){if(OT.Widget.options&&OT.Widget.options.waitlistEnabled){var firstTimeOption=$($timePicker.find("option")[0]);var hasNowOption=(firstTimeOption.text()===OT.Widget.timeNowLabel);if(!hasNowOption){firstTimeOption.text(OT.Widget.timeNowLabel);$timePicker.OTselect("select",firstTimeOption.attr('value'));}}};tabIndexCounter=setTabIndexes(formInputs,tabIndexCounter);setHighlighting(formInputs,labelInputs);selectInitValueFor.covers();selectInitValueFor.dateTime();hidePastTimes();updateTimeOptionsForWaitList();var getSearchObj=function(){var covers=$partySizePicker.OTselect("get"),selectedTime=$timePicker.OTselect("get"),selectedDate=$datepicker.OTdatepicker("get","yyyy-mm-dd"),dateTime=selectedDate+"T"+selectedTime;return{covers:covers,datetime:dateTime,sender:$dtp};};var onDTPChanged=function(){if(_shouldEmitChangedEvent){hidePastTimes();updateTimeOptionsForWaitList();var searchObj=getSearchObj();cookies.set(searchObj);OT.Events.fire("dtp:change",searchObj);}};$form.submit(function(e){e.preventDefault();OT.Events.fire("dtp:search",getSearchObj());return false;});OT.Events.on("datepicker:change",function(e,data){if(data.sender.is($datepicker)){fixDateTimeValues(onDTPChanged);}});OT.Events.on("select:change",function(e,data){if(data.sender.is($timePicker)){fixDateTimeValues(onDTPChanged);}else if(data.sender.is($partySizePicker)){onDTPChanged();}});$dtp.removeClass("ot-hide");OT.Events.fire("dtp:rendered",getSearchObj());});},set:function($dtp,obj){obj=obj||{};var partyChanged=false,timeChanged=false,dateChanged=false,$partySizePicker=$dtp.find(selectors.partySizePicker),$datePicker=$dtp.find(selectors.datePicker),$timePicker=$dtp.find(selectors.timePicker),fieldsChanged=0,fieldsToChange=0;if(!!obj.covers){if($partySizePicker.OTselect("get").toString()!==obj.covers.toString()){partyChanged=true;fieldsToChange++;}}if(!!obj.date){if($datePicker.OTdatepicker("get","yyyy-mm-dd").toString()!==obj.date.toString()){dateChanged=true;fieldsToChange++;}}if(!!obj.time){if($timePicker.OTselect("get").toString()!==obj.time.toString()){timeChanged=true;fieldsToChange++;}}var updateChangeEventEmitterCheck=function(){_shouldEmitChangedEvent=(fieldsToChange-fieldsChanged)<2;};updateChangeEventEmitterCheck();if(partyChanged){$partySizePicker.OTselect("select",obj.covers);fieldsChanged++;updateChangeEventEmitterCheck();}if(dateChanged){if(timeChanged){_validateDateTime=false;}$datePicker.OTdatepicker("set",obj.date);fieldsChanged++;updateChangeEventEmitterCheck();}if(timeChanged){_validateDateTime=true;$timePicker.OTselect("showAll");$timePicker.OTselect("select",obj.time);fieldsChanged++;updateChangeEventEmitterCheck();}}};$.fn.OTdtp=function(action,param){this.each(function(){var $this=$(this);if(action==="init"){return dtp.init($this);}else if(action==="set"){return dtp.set($this,param);}});};return dtp;})(jQuery,ot_,ot_moment);OT.createNS('OT.Widget');OT.Widget.Init=(function($,moment,$window,$document,undefined){var rid,searchHost,overlay,insideIframe,lang,r3abvariant;var doRestaurantSearch=function(e,data){if(r3abvariant){return;}var covers=parseInt(data.covers,10);var url,searchPath;if(covers===21&&!isNaN(rid)&&rid>0){searchPath='/private-dining/restaurant/'+rid;}else{searchPath='/restaurant/profile/'+rid+'/reserve';}var searchData={'covers':covers,'datetime':data.datetime,'restref':rid,'searchdatetime':data.datetime,'partysize':covers,'lang':lang};url=searchHost+searchPath+'?'+$.param(searchData);if(overlay&&insideIframe){$window.parent.postMessage({func:'ot-modal-open',params:{src:url}},'*');}else if(overlay){$($document).trigger('ot-modal-open',[url]);}else{$window.open(url,'_blank');}};var bindRestaurantSearch=function(options){if(options){rid=options.restaurantId;searchHost=options.searchHost;overlay=options.overlay;insideIframe=options.insideIframe;lang=options.lang;r3abvariant=options.r3abvariant;}OT.Events.on('dtp:search',doRestaurantSearch);};var openDatePicker=function(){if(OT.Widget.theme==='tall'){$("div.ot-date-picker > div.picker").addClass("picker--focused picker--opened");}};$($document).ready(function(){moment.locale(OT.Widget.lang||'en');$(".ot-dtp-picker").OTdtp("init");openDatePicker();OT.Common.Analytics.init(OT.Widget.omniture.vars||{});bindRestaurantSearch(OT.Widget.options||{});try{Typekit.load({async:true});$window.TypekitLoaded=true;}catch(e){$window.TypekitLoaded=false;}});})(jQuery,ot_moment,window,document);